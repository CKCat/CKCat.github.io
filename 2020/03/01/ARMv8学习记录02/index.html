<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"ckcat.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="前面的环境搭建好了，下面主要学习 ARMv8 的一些基本知识和指令 基本知识ARMv8 寄存器寄存器名称描述    位宽 分类      32-bit Wn（通用） WZR（0 寄存器） WSP（堆栈指针）   64-bit Xn（通用） XZR（0 寄存器） SP（堆栈指针）">
<meta property="og:type" content="article">
<meta property="og:title" content="ARMv8学习记录02">
<meta property="og:url" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/index.html">
<meta property="og:site_name" content="CKCat的博客">
<meta property="og:description" content="前面的环境搭建好了，下面主要学习 ARMv8 的一些基本知识和指令 基本知识ARMv8 寄存器寄存器名称描述    位宽 分类      32-bit Wn（通用） WZR（0 寄存器） WSP（堆栈指针）   64-bit Xn（通用） XZR（0 寄存器） SP（堆栈指针）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-15-57-08.png">
<meta property="og:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-16-00-41.png">
<meta property="og:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-19-15-20.png">
<meta property="og:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-21-46-28.png">
<meta property="og:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-21-48-58.png">
<meta property="og:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-21-49-14.png">
<meta property="article:published_time" content="2020-03-01T20:37:23.000Z">
<meta property="article:modified_time" content="2023-08-06T04:55:24.997Z">
<meta property="article:author" content="CKCat">
<meta property="article:tag" content="汇编">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-15-57-08.png">


<link rel="canonical" href="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/","path":"2020/03/01/ARMv8学习记录02/","title":"ARMv8学习记录02"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ARMv8学习记录02 | CKCat的博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">CKCat的博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="nav-number">1.</span> <span class="nav-text">基本知识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ARMv8-%E5%AF%84%E5%AD%98%E5%99%A8"><span class="nav-number">1.1.</span> <span class="nav-text">ARMv8 寄存器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E7%A0%81"><span class="nav-number">1.1.1.</span> <span class="nav-text">条件码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8C%87%E4%BB%A4"><span class="nav-number">2.</span> <span class="nav-text">指令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4"><span class="nav-number">2.1.</span> <span class="nav-text">数据处理指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E5%92%8C%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="nav-number">2.1.1.</span> <span class="nav-text">算术和逻辑运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%98%E6%B3%95%E5%92%8C%E9%99%A4%E6%B3%95%E6%8C%87%E4%BB%A4"><span class="nav-number">2.1.2.</span> <span class="nav-text">乘法和除法指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%BB%E4%BD%8D%E6%93%8D%E4%BD%9C"><span class="nav-number">2.1.3.</span> <span class="nav-text">移位操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8D%E5%92%8C%E5%AD%97%E8%8A%82%E6%93%8D%E4%BD%9C%E6%8C%87%E4%BB%A4"><span class="nav-number">2.1.4.</span> <span class="nav-text">位和字节操作指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E6%89%A7%E8%A1%8C"><span class="nav-number">2.1.5.</span> <span class="nav-text">条件执行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E8%AE%BF%E9%97%AE%E6%8C%87%E4%BB%A4"><span class="nav-number">2.2.</span> <span class="nav-text">内存访问指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E5%92%8C%E5%AD%98%E5%82%A8%E6%8C%87%E4%BB%A4"><span class="nav-number">2.2.1.</span> <span class="nav-text">加载和存储指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BB%E5%9D%80%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.2.2.</span> <span class="nav-text">寻址模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E6%8C%87%E4%BB%A4"><span class="nav-number">2.3.</span> <span class="nav-text">流程控制指令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#System"><span class="nav-number">2.4.</span> <span class="nav-text">System</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8C%87%E4%BB%A4%E8%AE%B0%E5%BD%95"><span class="nav-number">3.</span> <span class="nav-text">指令记录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#IT"><span class="nav-number">3.1.</span> <span class="nav-text">IT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TBNZ"><span class="nav-number">3.2.</span> <span class="nav-text">TBNZ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">4.</span> <span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CKCat</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">111</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CKCat" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CKCat" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ckcatck@qq.com" title="E-Mail → mailto:ckcatck@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ckcat.github.io/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CKCat">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CKCat的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ARMv8学习记录02 | CKCat的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ARMv8学习记录02
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-01 20:37:23" itemprop="dateCreated datePublished" datetime="2020-03-01T20:37:23+00:00">2020-03-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-06 04:55:24" itemprop="dateModified" datetime="2023-08-06T04:55:24+00:00">2023-08-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ARMv8%E6%B1%87%E7%BC%96/" itemprop="url" rel="index"><span itemprop="name">ARMv8汇编</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>前面的环境搭建好了，下面主要学习 ARMv8 的一些基本知识和指令</p>
<h1 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h1><h2 id="ARMv8-寄存器"><a href="#ARMv8-寄存器" class="headerlink" title="ARMv8 寄存器"></a>ARMv8 寄存器</h2><p>寄存器名称描述</p>
<table>
<thead>
<tr>
<th>位宽</th>
<th>分类</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>32-bit</td>
<td>Wn（通用）</td>
<td>WZR（0 寄存器）</td>
<td>WSP（堆栈指针）</td>
</tr>
<tr>
<td>64-bit</td>
<td>Xn（通用）</td>
<td>XZR（0 寄存器）</td>
<td>SP（堆栈指针）</td>
</tr>
</tbody></table>
<p>AArch64 通用寄存器共 31 个 <code>X0-X30</code> , 其中各寄存器的作用如下表。</p>
<table>
<thead>
<tr>
<th>寄存器</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>X0</code> – <code>X7</code></td>
<td>参数寄存器，用来传递参数或保存返回值 （<code>X0</code>，<code>X1</code>）。</td>
</tr>
<tr>
<td><code>X8</code></td>
<td>间接结果寄存器，一般保存返回值是结构体的地址。</td>
</tr>
<tr>
<td><code>X9</code> – <code>X15</code></td>
<td>易失性寄存器，调用者需要保存的临时寄存器。</td>
</tr>
<tr>
<td><code>X16</code> – <code>X17</code></td>
<td>子程序内部调用寄存器（Intra-Procedure-Call Temporary Registers）。</td>
</tr>
<tr>
<td><code>X18</code></td>
<td>平台寄存器（Platform Register），用于保存当前所用的平台的 ABI 。</td>
</tr>
<tr>
<td><code>X19</code> – <code>X28</code></td>
<td>非易失性寄存器，被调用者保存的寄存器。</td>
</tr>
<tr>
<td><code>X29</code></td>
<td>帧指针寄存器（FP），用于连接栈帧，使用时必须保存。</td>
</tr>
<tr>
<td><code>X30</code></td>
<td>链接寄存器（LR） 用于保存子程序的返回地址。</td>
</tr>
</tbody></table>
<p>除了 31 个核心寄存器外，还有一些特殊的寄存器。</p>
<p><strong>零寄存器 <code>XZR/WZR</code></strong> ：效果和软件层面的 <code>/dev/zero</code> 类似，作为源寄存器产生 0，作为目标寄存器丢弃传入的数据。</p>
<p><strong>栈指针寄存器 <code>SP</code>（Stack Pointer）</strong>：指向栈当前的位置。</p>
<p><strong>程序计数器 <code>PC</code>（Program Counter）</strong>：PC 总是指向当前指令下面的第二条指令的地址，不能被直接访问和修改。</p>
<p><strong>异常链接寄存器 <code>ELR</code>（Exception Link Register）</strong>：ELR 的作用是保存异常返回地址。</p>
<p><strong>进程状态保存寄存器</strong>：</p>
<ol>
<li>PSTATE at AArch64 (SPSR)</li>
</ol>
<img src="/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-15-57-08.png" class="">

<ol start="2">
<li>PSTATE at AArch32 (CPSR)</li>
</ol>
<img src="/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-16-00-41.png" class="">

<h3 id="条件码"><a href="#条件码" class="headerlink" title="条件码"></a>条件码</h3><p>此处的条件码对应的上面状态寄存器对应的标志位。</p>
<p>| Code | Encoding | Meaning (when set by CMP)                            | Meaning (when set by FCMP)                              | Condition flags      |<br>| —- | ——– | —————————————————- | ——————————————————- | ——————– | — | ——– |<br>| <code>EQ</code> | 0000     | Equal to.                                            | Equal to.                                               | <code>Z = 1</code>              |<br>| <code>NE</code> | 0001     | Not equal to.                                        | Unordered, or not equal to.                             | <code>Z = 0</code>              |<br>| <code>CS</code> | 0010     | Carry set (identical to HS).                         | Greater than, equal to, or unordered (identical to HS). | <code>C = 1</code>              |<br>| <code>HS</code> | 0010     | Greater than, equal to (unsigned) (identical to CS). | Greater than, equal to, or unordered (identical to CS). | <code>C = 1</code>              |<br>| <code>CC</code> | 0011     | Carry clear (identical to LO).                       | Less than (identical to LO).                            | <code>C = 0</code>              |<br>| <code>LO</code> | 0011     | Unsigned less than (identical to CC).                | Less than (identical to CC).                            | <code>C = 0</code>              |<br>| <code>MI</code> | 0100     | Minus, Negative.                                     | Less than.                                              | <code>N = 1</code>              |<br>| <code>PL</code> | 0101     | Positive or zero.                                    | Greater than, equal to, or unordered.                   | <code>N = 0</code>              |<br>| <code>VS</code> | 0110     | Signed overflow.                                     | Unordered. (At least one argument was NaN).             | <code>V = 1</code>              |<br>| <code>VC</code> | 0111     | No signed overflow.                                  | Not unordered. (No argument was NaN).                   | <code>V = 0</code>              |<br>| <code>HI</code> | 1000     | Greater than (unsigned).                             | Greater than or unordered.                              | <code>(C = 1) &amp;&amp; (Z = 0)</code> |<br>| <code>LS</code> | 1001     | Less than or equal to (unsigned).                    | Less than or equal to.                                  | <code>(C = 0)             |     | (Z = 1)</code> |<br>| <code>GE</code> | 1010     | Greater than or equal to (signed).                   | Greater than or equal to.                               | <code>N==V</code>               |<br>| <code>LT</code> | 1011     | Less than (signed).                                  | Less than or unordered.                                 | <code>N!=V</code>               |<br>| <code>GT</code> | 1100     | Greater than (signed).                               | Greater than.                                           | <code>(Z==0) &amp;&amp; (N==V)</code>   |<br>| <code>LE</code> | 1101     | Less than or equal to (signed).                      | Less than, equal to or unordered.                       | <code>(Z==1)              |     | (N!=V)</code>  |<br>| <code>AL</code> | 1110     | Always executed.                                     | Default. Always executed.                               | <code>Any</code>                |<br>| <code>NV</code> | 1111     | Always executed.                                     | Always executed.                                        | <code>Any</code>                |</p>
<h1 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h1><h2 id="数据处理指令"><a href="#数据处理指令" class="headerlink" title="数据处理指令"></a>数据处理指令</h2><h3 id="算术和逻辑运算"><a href="#算术和逻辑运算" class="headerlink" title="算术和逻辑运算"></a>算术和逻辑运算</h3><table>
<thead>
<tr>
<th>Type</th>
<th>Instructions</th>
</tr>
</thead>
<tbody><tr>
<td>算术</td>
<td><code>ADD</code>, <code>SUB</code>, <code>ADC</code>, <code>SBC</code>, <code>NEG</code>, <code>RSB</code></td>
</tr>
<tr>
<td>逻辑</td>
<td><code>AND</code>, <code>BIC</code>, <code>ORR</code>, <code>ORN</code>, <code>EOR</code>, <code>EON</code></td>
</tr>
<tr>
<td>比较</td>
<td><code>CMP</code>, <code>CMN</code>, <code>TST</code></td>
</tr>
<tr>
<td>移动</td>
<td><code>MOV</code>, <code>MVN</code></td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">ADC&#123;S&#125; rd, rn, rm         // rd = rn + rm + C</span><br><span class="line">ADD&#123;S&#125; rd, rn, op2        // rd = rn + op2</span><br><span class="line">ADR xd, rel               // xd = pc + re , rel 的值为 21 位有符号数。</span><br><span class="line">ADRP xd, rel              // xd = pc + rel , rel 的值为 33 位有符号数，并且 pc 和 rel 的值 4k 对齐，即低 12 位为 0 。</span><br><span class="line">CMN rd, op2               // rd + op2 影响标志位。</span><br><span class="line">CMP rd, op2               // rd - op2 影响标志位。</span><br><span class="line">MADD rd, rn, rm, ra       // rd = ra + rn * rm</span><br><span class="line">MSUB rd, rn, rm, ra       // rd = ra - rn * rm</span><br><span class="line">MNEG rd, rn, rm           // rd = - rn * rm</span><br><span class="line">MUL rd, rn, rm            // rd = rn * rm</span><br><span class="line">NEG&#123;S&#125; rd, op2            // rd = - op2</span><br><span class="line">NGC&#123;S&#125; rd, rm             // rd = -rm - ~C &lt;==&gt; rd = -rm + C - 1</span><br><span class="line">SBC&#123;S&#125; rd, rn, rm         // rd = rn -rm - ~C &lt;==&gt; rd = rn - rm + C - 1</span><br><span class="line">SDIV rd, rn, rm           // rd = rn / rm</span><br><span class="line">SMADDL Xd, Wn, Wm, Xa     // Xd = Xa + Wn * Wm</span><br><span class="line">SMNEGL Xd, Wn, Wm         // Xd = - Wn * Wm</span><br><span class="line">SMSUBL Xd, Wn, Wm, Xa     // Xd = Xa - Wn * Wm</span><br><span class="line">SMULH Xd, Xn, Xm          // Xd = (Xn * Xm) &gt;&gt; 64</span><br><span class="line">SMULL Xd, Wn, Wm          // Xd = Wn * Wm</span><br><span class="line">SUB&#123;S&#125; rd, rn, op2        // rd = rn - op2</span><br><span class="line">UDIV rd, rn, rm           // rd = rn / rm</span><br><span class="line">UMADDL Xd, Wn, Wm, Xa     // Xd = Xa + Wn * Wm</span><br><span class="line">UMNEGL Xd, Wn, Wm         // Xd = - Wn * Wm</span><br><span class="line">UMSUBL Xd, Wn, Wm, Xa     // Xd = Xa - Wn * Wm</span><br><span class="line">UMULH Xd, Xn, Xm          // Xd = Xn * Xm &gt;&gt; 64</span><br><span class="line">UMULL xd, Wn, Wm          // Xd = Wn * Wm</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CMN w0, #-3                    // 等价CMP W0, #3 即 x0 == 3</span><br><span class="line">ADD W0, W1, W2, LSL #3         // W0 = W1 + (W2 &lt;&lt; 3)</span><br><span class="line">SUBS X0, X4, X3, ASR #2        // X0 = X4 - (X3 &gt;&gt; 2), set flags</span><br><span class="line">MOV X0, X1                     // Copy X1 to X0</span><br><span class="line">CMP W3, W4                     // Set flags based on W3 - W4</span><br><span class="line">ADD W0, W5, #27                // W0 = W5 + 27</span><br><span class="line">MNEG w0, w1, w2                // w0 = w0 - w1 * w2</span><br><span class="line">NEG w0, w1                     // w0 = -w1</span><br><span class="line"></span><br><span class="line">and     x1, x0, 15             // x1 = x0 % 16</span><br><span class="line"></span><br><span class="line">tst     x0, x0                 // x0 == 0?</span><br><span class="line">beq     zero</span><br><span class="line"></span><br><span class="line">eor     x0, x0, x0             // x0 = 0</span><br></pre></td></tr></table></figure>

<h3 id="乘法和除法指令"><a href="#乘法和除法指令" class="headerlink" title="乘法和除法指令"></a>乘法和除法指令</h3><table>
<thead>
<tr>
<th>Opcode</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Multiply instructions</strong></td>
<td></td>
</tr>
<tr>
<td><code>MADD</code></td>
<td>Multiply add</td>
</tr>
<tr>
<td><code>MNEG</code></td>
<td>Multiply negate</td>
</tr>
<tr>
<td><code>MSUB</code></td>
<td>Multiply subtract</td>
</tr>
<tr>
<td><code>MUL</code></td>
<td>Multiply</td>
</tr>
<tr>
<td><code>SMADDL</code></td>
<td>Signed multiply-add long</td>
</tr>
<tr>
<td><code>SMNEGL</code></td>
<td>Signed multiply-negate long</td>
</tr>
<tr>
<td><code>SMSUBL</code></td>
<td>Signed multiply-subtract long</td>
</tr>
<tr>
<td><code>SMULH</code></td>
<td>Signed multiply returning high half</td>
</tr>
<tr>
<td><code>SMULL</code></td>
<td>Signed multiply long</td>
</tr>
<tr>
<td><code>UMADDL</code></td>
<td>Unsigned multiply-add long</td>
</tr>
<tr>
<td><code>UMNEGL</code></td>
<td>Unsigned multiply-negate long</td>
</tr>
<tr>
<td><code>UMSUBL</code></td>
<td>Unsigned multiply-subtract long</td>
</tr>
<tr>
<td><code>UMULH</code></td>
<td>Unsigned multiply returning high half</td>
</tr>
<tr>
<td><code>UMULL</code></td>
<td>Unsigned multiply long</td>
</tr>
<tr>
<td><strong>Divide instructions</strong></td>
<td></td>
</tr>
<tr>
<td><code>SDIV</code></td>
<td>Signed divide</td>
</tr>
<tr>
<td><code>UDIV</code></td>
<td>Unsigned divide</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MUL X0, X1, X2   // X0 = X1 * X2</span><br><span class="line">MNEG X0, X1, X2  // X0 = -(X1 * X2)</span><br><span class="line"></span><br><span class="line">UDIV W0, W1, W2  // W0 = W1 / W2 (unsigned, 32-bit divide)</span><br><span class="line">SDIV X0, X1, X2  // X0 = X1 / X2 (signed, 64-bit divide)</span><br></pre></td></tr></table></figure>

<h3 id="移位操作"><a href="#移位操作" class="headerlink" title="移位操作"></a>移位操作</h3><table>
<thead>
<tr>
<th>Instruction</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Shift</strong></td>
<td></td>
</tr>
<tr>
<td><code>ASR</code></td>
<td><strong>A</strong>rithmetic <strong>S</strong>hift <strong>R</strong>ight</td>
</tr>
<tr>
<td><code>LSL</code></td>
<td><strong>L</strong>ogical <strong>S</strong>hift <strong>L</strong>eft</td>
</tr>
<tr>
<td><code>LSR</code></td>
<td><strong>L</strong>ogical <strong>S</strong>hift <strong>R</strong>ight</td>
</tr>
<tr>
<td><code>ROR</code></td>
<td><strong>RO</strong>tate <strong>R</strong>ight</td>
</tr>
<tr>
<td><strong>Move</strong></td>
<td></td>
</tr>
<tr>
<td><code>MOV</code></td>
<td>Move</td>
</tr>
<tr>
<td><code>MVN</code></td>
<td>Bitwise NOT</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// x1 = x0 / 8</span><br><span class="line">lsr     x1, x0, 3</span><br><span class="line"></span><br><span class="line">// x1 = x0 * 4</span><br><span class="line">lsl     x1, x0, 2</span><br></pre></td></tr></table></figure>

<img src="/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-19-15-20.png" class="">

<h3 id="位和字节操作指令"><a href="#位和字节操作指令" class="headerlink" title="位和字节操作指令"></a>位和字节操作指令</h3><table>
<thead>
<tr>
<th>Mnemonic</th>
<th>Operands</th>
<th>Instruction</th>
</tr>
</thead>
<tbody><tr>
<td><code>BFI</code></td>
<td><code>Rd, Rn, #lsb, #width</code></td>
<td>Bitfield Insert copies any number of low-order bits from a source register into the same number of adjacent bits at any position in the destination register, leaving other bits unchanged.</td>
</tr>
<tr>
<td><code>BFM</code></td>
<td><code>Rd, Rn, #immr, #imms</code></td>
<td>Bitfield Move copies any number of low-order bits from a source register into the same number of adjacent bits at any position in the destination register, leaving other bits unchanged.</td>
</tr>
<tr>
<td><code>BFXIL</code></td>
<td><code>Rd, Rn, #lsb, #width</code></td>
<td>Bitfield extract and insert at low end copies any number of low-order bits from a source register into the same number of adjacent bits at the low end in the destination register, leaving other bits unchanged.</td>
</tr>
<tr>
<td><code>CLS</code></td>
<td><code>Rd, Rn</code></td>
<td>Count leading sign bits.</td>
</tr>
<tr>
<td><code>CLZ</code></td>
<td><code>Rd, Rn</code></td>
<td>Count leading zero bits.</td>
</tr>
<tr>
<td><code>EXTR</code></td>
<td><code>Rd, Rn, Rm, #lsb</code></td>
<td>Extract register extracts a register from a pair of registers.</td>
</tr>
<tr>
<td><code>RBIT</code></td>
<td><code>Rd, Rn</code></td>
<td>Reverse Bits reverses the bit order in a register.</td>
</tr>
<tr>
<td><code>REV16</code></td>
<td><code>Rd, Rn</code></td>
<td>Reverse bytes in 16-bit halfwords reverses the byte order in each 16-bit halfword of a register.</td>
</tr>
<tr>
<td><code>REV32</code></td>
<td><code>Rd, Rn</code></td>
<td>Reverse bytes in 32-bit words reverses the byte order in each 32-bit word of a register.</td>
</tr>
<tr>
<td><code>REV64</code></td>
<td><code>Rd, Rn</code></td>
<td>Reverse Bytes reverses the byte order in a 64-bit general-purpose register.</td>
</tr>
<tr>
<td><code>SBFIZ</code></td>
<td><code>Rd, Rn, #lsb, #width</code></td>
<td>Signed Bitfield Insert in Zero zeroes the destination register and copies any number of contiguous bits from a source register into any position in the destination register, sign-extending the most significant bit of the transferred value. Alias of SBFM.</td>
</tr>
<tr>
<td><code>SBFM</code></td>
<td><code>Wd, Wn, #immr, #imms</code></td>
<td>Signed Bitfield Move copies any number of low-order bits from a source register into the same number of adjacent bits at any position in the destination register, shifting in copies of the sign bit in the upper bits and zeros in the lower bits.</td>
</tr>
<tr>
<td><code>SBFX</code></td>
<td><code>Rd, Rn, #lsb, #width</code></td>
<td>Signed Bitfield Extract extracts any number of adjacent bits at any position from a register, sign-extends them to the size of the register, and writes the result to the destination register.</td>
</tr>
<tr>
<td><code>&#123;S,U&#125;XT&#123;B,H,W&#125;</code></td>
<td><code>Rd, Rn</code></td>
<td>(S)igned&#x2F;(U)nsigned eXtend (B)yte&#x2F;(H)alfword&#x2F;(W)ord extracts an 8-bit,16-bit or 32-bit value from a register, zero-extends it to the size of the register, and writes the result to the destination register. Alias of UBFM.</td>
</tr>
</tbody></table>
<img src="/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-21-46-28.png" class="">

<img src="/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-21-48-58.png" class="">

<img src="/2020/03/01/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9502/2020-03-09-21-49-14.png" class="">

<h3 id="条件执行"><a href="#条件执行" class="headerlink" title="条件执行"></a>条件执行</h3><table>
<thead>
<tr>
<th>Mnemonic</th>
<th>Operands</th>
<th>Instruction</th>
</tr>
</thead>
<tbody><tr>
<td><code>CCMN</code> (immediate)</td>
<td><code>Rn, #imm, #nzcv, cond</code></td>
<td>Conditional Compare Negative (immediate) sets the value of the condition flags to the result of the comparison of a register value and a negated immediate value if the condition is TRUE, and an immediate value otherwise.</td>
</tr>
<tr>
<td><code>CCMN</code> (register)</td>
<td><code>Rn, Rm, #nzcv, cond</code></td>
<td>Conditional Compare Negative (register) sets the value of the condition flags to the result of the comparison of a register value and the inverse of another register value if the condition is TRUE, and an immediate value otherwise.</td>
</tr>
<tr>
<td><code>CCMP</code> (immediate)</td>
<td><code>Rn, #imm, #nzcv, cond</code></td>
<td>Conditional Compare (immediate) sets the value of the condition flags to the result of the comparison of a register value and an immediate value if the condition is TRUE, and an immediate value otherwise.</td>
</tr>
<tr>
<td><code>CCMP</code> (register)</td>
<td><code>Rn, Rm, #nzcv, cond</code></td>
<td>Conditional Compare (register) sets the value of the condition flags to the result of the comparison of two registers if the condition is TRUE, and an immediate value otherwise.</td>
</tr>
<tr>
<td><code>CSEL</code></td>
<td><code>Rd, Rn, Rm, cond</code></td>
<td>Conditional Select returns, in the destination register, the value of the first source register if the condition is TRUE, and otherwise returns the value of the second source register.</td>
</tr>
<tr>
<td><code>CSINC</code></td>
<td><code>Rd, Rn, Rm, cond</code></td>
<td>Conditional Select Increment returns, in the destination register, the value of the first source register if the condition is TRUE, and otherwise returns the value of the second source register incremented by 1. Used by CINC and CSET.</td>
</tr>
<tr>
<td><code>CSINV</code></td>
<td><code>Rd, Rn, Rm, cond</code></td>
<td>Conditional Select Invert returns, in the destination register, the value of the first source register if the condition is TRUE, and otherwise returns the bitwise inversion value of the second source register. Used by CINV and CSETM.</td>
</tr>
<tr>
<td><code>CSNEG</code></td>
<td><code>Rd, Rn, Rm, cond</code></td>
<td>Conditional Select Negation returns, in the destination register, the value of the first source register if the condition is TRUE, and otherwise returns the negated value of the second source register. Used by CNEG.</td>
</tr>
<tr>
<td><code>CSET</code></td>
<td><code>Rd, cond</code></td>
<td>Conditional Set sets the destination register to 1 if the condition is TRUE, and otherwise sets it to 0.</td>
</tr>
<tr>
<td><code>CSETM</code></td>
<td><code>Rd, cond</code></td>
<td>Conditional Set Mask sets all bits of the destination register to 1 if the condition is TRUE, and otherwise sets all bits to 0.</td>
</tr>
<tr>
<td><code>CINC</code></td>
<td><code>Rd, Rn, cond</code></td>
<td>Conditional Increment returns, in the destination register, the value of the source register incremented by 1 if the condition is TRUE, and otherwise returns the value of the source register.</td>
</tr>
<tr>
<td><code>CINV</code></td>
<td><code>Rd, Rn, cond</code></td>
<td>Conditional Invert returns, in the destination register, the bitwise inversion of the value of the source register if the condition is TRUE, and otherwise returns the value of the source register.</td>
</tr>
<tr>
<td><code>CNEG</code></td>
<td><code>Rd, Rn, cond</code></td>
<td>Conditional Negate returns, in the destination register, the negated value of the source register if the condition is TRUE, and otherwise returns the value of the source register.</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CSINC X0, X1, X0, NE  // Set the return register X0 to X1 if Zero flag clear, else increment X0</span><br><span class="line">CINC X0, X0, LS       // If less than or same (LS) then X0 = X0 + 1</span><br><span class="line">CSET W0, EQ           // If the previous comparison was equal (Z=1) then W0 = 1,</span><br><span class="line">                      // else W0 = 0</span><br><span class="line">CSETM X0, NE          // If not equal then X0 = -1, else X0 = 0</span><br><span class="line"></span><br><span class="line">                      //if (i == 0) r = r + 2; else r = r - 1;</span><br><span class="line">CMP w0, #0            // if (i == 0)</span><br><span class="line">SUB w2, w1, #1        // r = r - 1</span><br><span class="line">ADD w1, w1, #2        // r = r + 2</span><br><span class="line">CSEL w1, w1, w2, EQ   // select between the two results</span><br></pre></td></tr></table></figure>

<h2 id="内存访问指令"><a href="#内存访问指令" class="headerlink" title="内存访问指令"></a>内存访问指令</h2><h3 id="加载和存储指令"><a href="#加载和存储指令" class="headerlink" title="加载和存储指令"></a>加载和存储指令</h3><p>| Mnemonic | Operands       | Instruction |<br>| ——– | ————– | ———– | —————————————————————————————————————————————————————————————————– | —- | ——– | ———– | ———————————————————————————————————————————————————————————————– | ———————————————————————————————————————————————————————————————————————————————– |<br>| <code>LDR(B   | H              | SB          | SH                                                                                                                                                                                                    | SW)</code> | <code>Wt, [Xn | SP], #simm</code> | Load Register (immediate) loads a word or doubleword from memory and writes it to a register. The address that is used for the load is calculated from a base register and an immediate offset. |<br>| <code>LD(B    | H              | SB          | SH                                                                                                                                                                                                    | SW)</code> | <code>Wt, [Xn | SP, (Wm     | Xm)&#123;, extend &#123;amount&#125;&#125;]</code>                                                                                                                                                                        | Load Register (register) calculates an address from a base register value and an offset register value, loads a byte&#x2F;half-word&#x2F;word from memory, and writes it to a register. The offset register value can optionally be shifted and extended. |<br>| <code>STR(B   | H              | SB          | SH                                                                                                                                                                                                    | SW)</code> | <code>Wt, [Xn | SP], #simm</code> | Store Register (immediate) stores a word or a doubleword from a register to memory. The address that is used for the store is calculated from a base register and an immediate offset.          |<br>| <code>STR(B   | H              | SB          | SH                                                                                                                                                                                                    | SW)</code> | <code>Wt, [Xn | SP, (Wm     | Xm)&#123;, extend &#123;amount&#125;&#125;]</code>                                                                                                                                                                        | Store Register (immediate) stores a word or a doubleword from a register to memory. The address that is used for the store is calculated from a base register and an immediate offset.                                                          |<br>| <code>LDP</code>    | <code>Wt1, Wt2, [Xn | SP], #imm</code>  | Load Pair of Registers calculates an address from a base register value and an immediate offset, loads two 32-bit words or two 64-bit doublewords from memory, and writes them to two registers.      |<br>| <code>STP</code>    | <code>Wt1, Wt2, [Xn | SP], #imm</code>  | Store Pair of Registers calculates an address from a base register value and an immediate offset, and stores two 32-bit words or two 64-bit doublewords to the calculated address, from two registers |</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// load a byte from x1</span><br><span class="line">ldrb    w0, [x1]</span><br><span class="line"></span><br><span class="line">// load a signed byte from x1</span><br><span class="line">ldrsb   w0, [x1]</span><br><span class="line"></span><br><span class="line">// store a 32-bit word to address in x1</span><br><span class="line">str     w0, [x1]</span><br><span class="line"></span><br><span class="line">// load two 32-bit words from stack, advance sp by 8</span><br><span class="line">ldp     w0, w1, [sp], 8</span><br><span class="line"></span><br><span class="line">// store two 64-bit words at [sp-96] and subtract 96 from sp</span><br><span class="line">stp     x0, x1, [sp, -96]!</span><br><span class="line"></span><br><span class="line">// load 32-bit immediate from literal pool</span><br><span class="line">ldr     w0, =0x12345678</span><br></pre></td></tr></table></figure>

<h3 id="寻址模式"><a href="#寻址模式" class="headerlink" title="寻址模式"></a>寻址模式</h3><p>| Addressing Mode                | Immediate       | Register                | Extended Register |<br>| —————————— | ————— | ———————– | —————– | —————- |<br>| Base register only (no offset) | <code>[base&#123;, 0&#125;]</code>   |                         |                   |<br>| Base plus offset               | <code>[base&#123;, imm&#125;]</code> | <code>[base, Xm&#123;, LSL imm&#125;]</code> | <code>[base, Wm, (S    | U)XTW &#123; #imm &#125;]</code> |<br>| Pre-indexed                    | <code>[base, imm]!</code>  |                         |                   |<br>| Post-indexed                   | <code>[base], imm</code>   | <code>[base], Xm a</code>          |                   |<br>| Literal (PC-relative)          | <code>label</code>         |                         |                   |</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">// load a byte from x1</span><br><span class="line">ldrb   w0, [x1]</span><br><span class="line"></span><br><span class="line">// load a half-word from x1</span><br><span class="line">ldrh   w0, [x1]</span><br><span class="line"></span><br><span class="line">// load a word from x1</span><br><span class="line">ldr    w0, [x1]</span><br><span class="line"></span><br><span class="line">// load a doubleword from x1</span><br><span class="line">ldr    x0, [x1]</span><br><span class="line"></span><br><span class="line">// load a byte from x1 plus 1</span><br><span class="line">ldrb   w0, [x1, 1]</span><br><span class="line"></span><br><span class="line">// load a half-word from x1 plus 2</span><br><span class="line">ldrh   w0, [x1, 2]</span><br><span class="line"></span><br><span class="line">// load a word from x1 plus 4</span><br><span class="line">ldr    w0, [x1, 4]</span><br><span class="line"></span><br><span class="line">// load a doubleword from x1 plus 8</span><br><span class="line">ldr    x0, [x1, 8]</span><br><span class="line"></span><br><span class="line">// load a doubleword from x1 using x2 as index</span><br><span class="line">// w2 is multiplied by 8</span><br><span class="line">ldr    x0, [x1, x2, lsl 3]</span><br><span class="line"></span><br><span class="line">// load a doubleword from x1 using w2 as index</span><br><span class="line">// w2 is zero-extended and multiplied by 8</span><br><span class="line">ldr    x0, [x1, w2, uxtw 3]</span><br><span class="line">// load a byte from x1 plus 1, then advance x1 by 1</span><br><span class="line">ldrb   w0, [x1, 1]!</span><br><span class="line"></span><br><span class="line">// load a half-word from x1 plus 2, then advance x1 by 2</span><br><span class="line">ldrh   w0, [x1, 2]!</span><br><span class="line"></span><br><span class="line">// load a word from x1 plus 4, then advance x1 by 4</span><br><span class="line">ldr    w0, [x1, 4]!</span><br><span class="line"></span><br><span class="line">// load a doubleword from x1 plus 8, then advance x1 by 8</span><br><span class="line">ldr    x0, [x1, 8]!</span><br><span class="line">// load a byte from x1, then advance x1 by 1</span><br><span class="line">ldrb   w0, [x1], 1</span><br><span class="line"></span><br><span class="line">// load a half-word from x1, then advance x1 by 2</span><br><span class="line">ldrh   w0, [x1], 2</span><br><span class="line"></span><br><span class="line">// load a word from x1, then advance x1 by 4</span><br><span class="line">ldr    w0, [x1], 4</span><br><span class="line"></span><br><span class="line">// load a doubleword from x1, then advance x1 by 8</span><br><span class="line">ldr    x0, [x1], 8</span><br><span class="line"></span><br><span class="line">  // load address of label</span><br><span class="line">adr    x0, label</span><br><span class="line"></span><br><span class="line">// load address of label</span><br><span class="line">adrp   x0, label</span><br></pre></td></tr></table></figure>

<h2 id="流程控制指令"><a href="#流程控制指令" class="headerlink" title="流程控制指令"></a>流程控制指令</h2><table>
<thead>
<tr>
<th>Mnemonic</th>
<th>Operands</th>
<th>Instruction</th>
</tr>
</thead>
<tbody><tr>
<td><code>B</code></td>
<td><code>label</code></td>
<td>Branch causes an unconditional branch to a label at a PC-relative offset, with a hint that this is not a subroutine call or return.</td>
</tr>
<tr>
<td><code>B.cond</code></td>
<td><code>label</code></td>
<td>Branch conditionally to a label at a PC-relative offset, with a hint that this is not a subroutine call or return.</td>
</tr>
<tr>
<td><code>BL</code></td>
<td><code>label</code></td>
<td>Branch with Link branches to a PC-relative offset, setting the register X30 to PC+4. It provides a hint that this is a subroutine call.</td>
</tr>
<tr>
<td><code>BLR</code></td>
<td><code>Xn</code></td>
<td>Branch with Link to Register calls a subroutine at an address in a register, setting register X30 to PC+4.</td>
</tr>
<tr>
<td><code>BR</code></td>
<td><code>Xn</code></td>
<td>Branch to Register branches unconditionally to an address in a register, with a hint that this is not a subroutine return.</td>
</tr>
<tr>
<td><code>CBNZ</code></td>
<td><code>Rn, label</code></td>
<td>Compare and Branch on Nonzero compares the value in a register with zero, and conditionally branches to a label at a PC-relative offset if the comparison is not equal. It provides a hint that this is not a subroutine call or return. This instruction does not affect the condition flags.</td>
</tr>
<tr>
<td><code>CBZ</code></td>
<td><code>Rn, label</code></td>
<td>Compare and Branch on Zero compares the value in a register with zero, and conditionally branches to a label at a PC-relative offset if the comparison is equal. It provides a hint that this is not a subroutine call or return. This instruction does not affect condition flags.</td>
</tr>
<tr>
<td><code>RET</code></td>
<td><code>Xn</code></td>
<td>Return from subroutine branches unconditionally to an address in a register, with a hint that this is a subroutine return.</td>
</tr>
<tr>
<td><code>TBNZ</code></td>
<td><code>Rn, #imm, label</code></td>
<td>Test bit and Branch if Nonzero compares the value of a bit in a general-purpose register with zero, and conditionally branches to a label at a PC-relative offset if the comparison is not equal. It provides a hint that this is not a subroutine call or return. This instruction does not affect condition flags.</td>
</tr>
<tr>
<td><code>TBZ</code></td>
<td><code>Rn, #imm, label</code></td>
<td>Test bit and Branch if Zero compares the value of a test bit with zero, and conditionally branches to a label at a PC-relative offset if the comparison is equal. It provides a hint that this is not a subroutine call or return. This instruction does not affect condition flags.</td>
</tr>
</tbody></table>
<h2 id="System"><a href="#System" class="headerlink" title="System"></a>System</h2><table>
<thead>
<tr>
<th>Mnemonic</th>
<th>Instruction</th>
</tr>
</thead>
<tbody><tr>
<td><code>MSR</code></td>
<td>Move general-purpose register to System Register allows the PE to write an AArch64 System register from a general-purpose register.</td>
</tr>
<tr>
<td><code>MRS</code></td>
<td>Move System Register allows the PE to read an AArch64 System register into a general-purpose register.</td>
</tr>
<tr>
<td><code>SVC</code></td>
<td>Supervisor Call causes an exception to be taken to EL1.</td>
</tr>
<tr>
<td><code>NOP</code></td>
<td>No Operation does nothing, other than advance the value of the program counter by 4. This instruction can be used for instruction alignment purposes.</td>
</tr>
</tbody></table>
<h1 id="指令记录"><a href="#指令记录" class="headerlink" title="指令记录"></a>指令记录</h1><p>本节主要记录一些自已不知道其含义的指令，后续通过查询资料后才弄懂的指令，由于比较容易忘记，故记录下来。</p>
<h2 id="IT"><a href="#IT" class="headerlink" title="IT"></a>IT</h2><p>分支语句（If-Then），该指令根据特定条件来执行紧随其后的 1~4 条指令，格式为 <code>IT&#123;x&#123;y&#123;z&#125;&#125;&#125; &#123;cond&#125;</code>。其中 x 、y 、z 分别是执行第二、三、四条指令的条件，可取的值为 T(<strong>T</strong>hen)或 E(<strong>E</strong>lse)，对应于条件的成立和不成立。cond 指定 <code>IT</code> 块中第一条指令的条件。下面来看例子：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ITETT</span> EQ</span><br><span class="line"><span class="keyword">MOVEQ</span> <span class="built_in">R0</span>, <span class="number">#1</span><span class="comment">;	//指令1</span></span><br><span class="line"><span class="keyword">MOVNE</span> <span class="built_in">R0</span>, <span class="number">#0</span><span class="comment">;	//指令2</span></span><br><span class="line"><span class="keyword">MOVEQ</span> <span class="built_in">R1</span>, <span class="number">#0</span><span class="comment">;	//指令3</span></span><br><span class="line"><span class="keyword">MOVEQ</span> <span class="built_in">R2</span>, <span class="number">#0</span><span class="comment">;	//指令4</span></span><br></pre></td></tr></table></figure>

<p>若 <code>EQ</code> 条件符合（根据 <code>CPSR</code> 寄存器 <code>Z</code> 的值判断），执行指令 1 、3 、4 的 <code>mov</code> 操作，否则执行指令 2 的 <code>mov</code> 操作。</p>
<h2 id="TBNZ"><a href="#TBNZ" class="headerlink" title="TBNZ"></a>TBNZ</h2><p>指令格式为：<code>TBNZ Rt, #imm, label</code> 。</p>
<p>测试位不为 0，则跳转到 label，imm 指定目的寄存器的某一个位， 其值为 0-63 或者 0-31 。</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">TBNZ</span> W0, <span class="number">#31</span>, loc_16B4  # 若 w0 第<span class="number">31</span>位不为<span class="number">0</span>，则跳转到 loc_16B4</span><br></pre></td></tr></table></figure>

<p><code>TBZ</code> 则是测试位为 0，则跳转。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://modexp.wordpress.com/2018/10/30/arm64-assembly/">A Guide to ARM64 &#x2F; AArch64 Assembly on Linux with Shellcodes and Cryptography</a></p>
<p><a target="_blank" rel="noopener" href="https://static.docs.arm.com/den0024/a/DEN0024A_v8_architecture_PG.pdf">DEN0024A_v8_architecture_PG.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://courses.cs.washington.edu/courses/cse469/19wi/arm64.pdf">ARMv8 A64 Quick Reference</a></p>
<p><a target="_blank" rel="noopener" href="https://cataloc.gitee.io/blog/2021/06/03/Armv8%E6%9E%B6%E6%9E%84%E7%AE%80%E4%BB%8B">Armv8 架构简介</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B1%87%E7%BC%96/" rel="tag"># 汇编</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/02/28/ARMv8%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%9501/" rel="prev" title="ARMv8学习记录01">
                  <i class="fa fa-chevron-left"></i> ARMv8学习记录01
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/03/05/github%E9%A1%B9%E7%9B%AE%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/" rel="next" title="github项目搜索技巧">
                  github项目搜索技巧 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CKCat</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/CKCat" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
