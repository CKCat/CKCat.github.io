<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"ckcat.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="模板 创建示例项目   模板语言 模板变量 示例   标签 示例   过滤器 示例   自定义过滤器 示例   注释   模板继承 父模板 子模板 示例   HTML 转义 示例   关闭转义 字符串字面值   CSRF 示例 防止 CSRF 保护原理   验证码 手动实现验证码 调用验证码 验证   反向解析 示例 URL 的参数 情况一：位置参数 情况二：关键字参数        模板作">
<meta property="og:type" content="article">
<meta property="og:title" content="Django学习-模板">
<meta property="og:url" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/index.html">
<meta property="og:site_name" content="CKCat的博客">
<meta property="og:description" content="模板 创建示例项目   模板语言 模板变量 示例   标签 示例   过滤器 示例   自定义过滤器 示例   注释   模板继承 父模板 子模板 示例   HTML 转义 示例   关闭转义 字符串字面值   CSRF 示例 防止 CSRF 保护原理   验证码 手动实现验证码 调用验证码 验证   反向解析 示例 URL 的参数 情况一：位置参数 情况二：关键字参数        模板作">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-21-43-31.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-21-57-34.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-10-03.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-12-48.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-20-04.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-24-29.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-34-10.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-02-15.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-07-07.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-11-53.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-14-39.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-16-22.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-17-40.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-08-38.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-09-09.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-12-25.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-14-10.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-14-52.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-18-52.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-24-25.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-50-30.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-51-13.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-06-23-39-53.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-06-23-54-38.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-00-32-11.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-00-32-32.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-22-58-53.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-23-00-17.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-23-14-32.png">
<meta property="og:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-23-19-25.png">
<meta property="article:published_time" content="2020-01-04T20:51:52.000Z">
<meta property="article:modified_time" content="2023-10-12T11:47:49.695Z">
<meta property="article:author" content="CKCat">
<meta property="article:tag" content="Django">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-21-43-31.png">


<link rel="canonical" href="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/","path":"2020/01/04/Django学习-模板/","title":"Django学习-模板"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Django学习-模板 | CKCat的博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">CKCat的博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF"><span class="nav-number">1.</span> <span class="nav-text">模板</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%A4%BA%E4%BE%8B%E9%A1%B9%E7%9B%AE"><span class="nav-number">1.1.</span> <span class="nav-text">创建示例项目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E8%AF%AD%E8%A8%80"><span class="nav-number">2.</span> <span class="nav-text">模板语言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%8F%98%E9%87%8F"><span class="nav-number">2.1.</span> <span class="nav-text">模板变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.1.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE"><span class="nav-number">2.2.</span> <span class="nav-text">标签</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">2.3.</span> <span class="nav-text">过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2"><span class="nav-number">2.3.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-number">2.4.</span> <span class="nav-text">自定义过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-3"><span class="nav-number">2.4.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">2.5.</span> <span class="nav-text">注释</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E7%BB%A7%E6%89%BF"><span class="nav-number">3.</span> <span class="nav-text">模板继承</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%88%B6%E6%A8%A1%E6%9D%BF"><span class="nav-number">3.1.</span> <span class="nav-text">父模板</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%A8%A1%E6%9D%BF"><span class="nav-number">3.2.</span> <span class="nav-text">子模板</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-4"><span class="nav-number">3.2.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTML-%E8%BD%AC%E4%B9%89"><span class="nav-number">3.3.</span> <span class="nav-text">HTML 转义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-5"><span class="nav-number">3.3.1.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E8%BD%AC%E4%B9%89"><span class="nav-number">3.4.</span> <span class="nav-text">关闭转义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%97%E9%9D%A2%E5%80%BC"><span class="nav-number">3.5.</span> <span class="nav-text">字符串字面值</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CSRF"><span class="nav-number">4.</span> <span class="nav-text">CSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-6"><span class="nav-number">4.1.</span> <span class="nav-text">示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%98%B2%E6%AD%A2-CSRF"><span class="nav-number">4.2.</span> <span class="nav-text">防止 CSRF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%9D%E6%8A%A4%E5%8E%9F%E7%90%86"><span class="nav-number">4.3.</span> <span class="nav-text">保护原理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81"><span class="nav-number">5.</span> <span class="nav-text">验证码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0%E9%AA%8C%E8%AF%81%E7%A0%81"><span class="nav-number">5.1.</span> <span class="nav-text">手动实现验证码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E9%AA%8C%E8%AF%81%E7%A0%81"><span class="nav-number">5.2.</span> <span class="nav-text">调用验证码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81"><span class="nav-number">5.3.</span> <span class="nav-text">验证</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E8%A7%A3%E6%9E%90"><span class="nav-number">6.</span> <span class="nav-text">反向解析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-7"><span class="nav-number">6.1.</span> <span class="nav-text">示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#URL-%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-number">6.2.</span> <span class="nav-text">URL 的参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%86%B5%E4%B8%80%EF%BC%9A%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="nav-number">6.2.1.</span> <span class="nav-text">情况一：位置参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%83%85%E5%86%B5%E4%BA%8C%EF%BC%9A%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0"><span class="nav-number">6.2.2.</span> <span class="nav-text">情况二：关键字参数</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CKCat</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">119</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CKCat" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CKCat" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ckcatck@qq.com" title="E-Mail → mailto:ckcatck@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ckcat.github.io/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CKCat">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CKCat的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Django学习-模板 | CKCat的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Django学习-模板
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-01-04 20:51:52" itemprop="dateCreated datePublished" datetime="2020-01-04T20:51:52+00:00">2020-01-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-10-12 11:47:49" itemprop="dateModified" datetime="2023-10-12T11:47:49+00:00">2023-10-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <!-- TOC -->

<ul>
<li><a href="#%E6%A8%A1%E6%9D%BF">模板</a><ul>
<li><a href="#%E5%88%9B%E5%BB%BA%E7%A4%BA%E4%BE%8B%E9%A1%B9%E7%9B%AE">创建示例项目</a></li>
</ul>
</li>
<li><a href="#%E6%A8%A1%E6%9D%BF%E8%AF%AD%E8%A8%80">模板语言</a><ul>
<li><a href="#%E6%A8%A1%E6%9D%BF%E5%8F%98%E9%87%8F">模板变量</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
</ul>
</li>
<li><a href="#%E6%A0%87%E7%AD%BE">标签</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
</ul>
</li>
<li><a href="#%E8%BF%87%E6%BB%A4%E5%99%A8">过滤器</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
</ul>
</li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8">自定义过滤器</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
</ul>
</li>
<li><a href="#%E6%B3%A8%E9%87%8A">注释</a></li>
</ul>
</li>
<li><a href="#%E6%A8%A1%E6%9D%BF%E7%BB%A7%E6%89%BF">模板继承</a><ul>
<li><a href="#%E7%88%B6%E6%A8%A1%E6%9D%BF">父模板</a></li>
<li><a href="#%E5%AD%90%E6%A8%A1%E6%9D%BF">子模板</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
</ul>
</li>
<li><a href="#html-%E8%BD%AC%E4%B9%89">HTML 转义</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
</ul>
</li>
<li><a href="#%E5%85%B3%E9%97%AD%E8%BD%AC%E4%B9%89">关闭转义</a></li>
<li><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%97%E9%9D%A2%E5%80%BC">字符串字面值</a></li>
</ul>
</li>
<li><a href="#csrf">CSRF</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
<li><a href="#%E9%98%B2%E6%AD%A2-csrf">防止 CSRF</a></li>
<li><a href="#%E4%BF%9D%E6%8A%A4%E5%8E%9F%E7%90%86">保护原理</a></li>
</ul>
</li>
<li><a href="#%E9%AA%8C%E8%AF%81%E7%A0%81">验证码</a><ul>
<li><a href="#%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0%E9%AA%8C%E8%AF%81%E7%A0%81">手动实现验证码</a></li>
<li><a href="#%E8%B0%83%E7%94%A8%E9%AA%8C%E8%AF%81%E7%A0%81">调用验证码</a></li>
<li><a href="#%E9%AA%8C%E8%AF%81">验证</a></li>
</ul>
</li>
<li><a href="#%E5%8F%8D%E5%90%91%E8%A7%A3%E6%9E%90">反向解析</a><ul>
<li><a href="#%E7%A4%BA%E4%BE%8B">示例</a></li>
<li><a href="#url-%E7%9A%84%E5%8F%82%E6%95%B0">URL 的参数</a><ul>
<li><a href="#%E6%83%85%E5%86%B5%E4%B8%80%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0">情况一：位置参数</a></li>
<li><a href="#%E6%83%85%E5%86%B5%E4%BA%8C%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0">情况二：关键字参数</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->

<h1 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h1><p>作为 Web 框架，Django 提供了模板，用于编写 html 代码，还可以嵌入模板代码更快更方便的完成页面开发，再通过在视图中渲染模板，将生成最终的 html 字符串返回给客户端浏览器。模版致力于表达外观，而不是程序逻辑。模板的设计实现了业务逻辑 view 与显示内容 template 的分离，一个视图可以使用任意一个模板，一个模板可以供多个视图使用。</p>
<p>模板包含两部分：</p>
<ul>
<li>静态部分，包含 html、css、js 。</li>
<li>动态部分，就是模板语言。</li>
</ul>
<p>Django 模板语言，简写 DTL ，定义在 <code>django.template</code> 包中。 创建项目后，在 <code>项目名称/settings.py</code> 文件中定义了关于模板的配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        &#x27;BACKEND&#x27;: &#x27;django.template.backends.django.DjangoTemplates&#x27;,</span><br><span class="line">        &#x27;DIRS&#x27;: [os.path.join(BASE_DIR, &#x27;templates&#x27;)],</span><br><span class="line">        &#x27;APP_DIRS&#x27;: True,</span><br><span class="line">        &#x27;OPTIONS&#x27;: &#123;</span><br><span class="line">            &#x27;context_processors&#x27;: [</span><br><span class="line">                &#x27;django.template.context_processors.debug&#x27;,</span><br><span class="line">                &#x27;django.template.context_processors.request&#x27;,</span><br><span class="line">                &#x27;django.contrib.auth.context_processors.auth&#x27;,</span><br><span class="line">                &#x27;django.contrib.messages.context_processors.messages&#x27;,</span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>DIRS 定义一个目录列表，模板引擎按列表顺序搜索这些目录以查找模板文件，通常是在项目的根目录下创建 templates 目录。</p>
<p>Django 处理模板分为两个阶段：</p>
<ol>
<li>加载：根据给定的路径找到模板文件，编译后放在内存中。</li>
<li>渲染：使用上下文数据对模板插值并返回生成的字符串。</li>
</ol>
<p>为了减少开发人员重复编写加载、渲染的代码，Django 提供了简写函数 render，用于调用模板。</p>
<h2 id="创建示例项目"><a href="#创建示例项目" class="headerlink" title="创建示例项目"></a>创建示例项目</h2><p>1）创建项目 test4 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject test4</span><br></pre></td></tr></table></figure>

<p>2）进入项目目录 test4 ，创建应用 booktest 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd test4</span><br><span class="line">python manage.py startapp booktest</span><br></pre></td></tr></table></figure>

<p>3）在 <code>test4/settings.py</code> 中 INSTALLED_APPS 项安装应用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = (</span><br><span class="line">    &#x27;django.contrib.admin&#x27;,</span><br><span class="line">    &#x27;django.contrib.auth&#x27;,</span><br><span class="line">    &#x27;django.contrib.contenttypes&#x27;,</span><br><span class="line">    &#x27;django.contrib.sessions&#x27;,</span><br><span class="line">    &#x27;django.contrib.messages&#x27;,</span><br><span class="line">    &#x27;django.contrib.staticfiles&#x27;,</span><br><span class="line">    &#x27;booktest&#x27;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>4）在 <code>test4/settings.py</code> 中 DATABASES 项配置使用 MySQL 数据库 test2 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    &#x27;default&#x27;: &#123;</span><br><span class="line">        # &#x27;ENGINE&#x27;: &#x27;django.db.backends.sqlite3&#x27;,</span><br><span class="line">        # &#x27;NAME&#x27;: os.path.join(BASE_DIR, &#x27;db.sqlite3&#x27;),</span><br><span class="line">        &#x27;ENGINE&#x27;: &#x27;django.db.backends.mysql&#x27;,</span><br><span class="line">        &#x27;NAME&#x27;: &#x27;test2&#x27;,</span><br><span class="line">        &#x27;HOST&#x27;: &#x27;localhost&#x27;,</span><br><span class="line">        &#x27;PORT&#x27;: &#x27;3306&#x27;,</span><br><span class="line">        &#x27;USER&#x27;: &#x27;ckcat&#x27;,</span><br><span class="line">        &#x27;PASSWORD&#x27;: &#x27;mysql&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 <code>test4/__init__.py</code>中添加以下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure>

<p>5）在 <code>test4/settings.py</code>中 TEMPLATES 项配置模板查找路径，并创建模板文件夹 <code>templates</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;DIRS&#x27;: [os.path.join(BASE_DIR, &#x27;templates&#x27;)],</span><br></pre></td></tr></table></figure>

<p>6）打开 <code>test4/urls.py</code> 文件，包含 booktest 的 url 配置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import include, url</span><br><span class="line">from django.contrib import admin</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&#x27;^admin/&#x27;, include(admin.site.urls)),</span><br><span class="line">    url(r&#x27;^&#x27;, include(&#x27;booktest.urls&#x27;)),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>7）创建 <code>booktest/urls.py</code> ，配置 url 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import url</span><br><span class="line">from booktest import views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&#x27;^$&#x27;, views.index)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>8）打开 <code>booktest/views.py</code> 文件，定义视图 index。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from django.shortcuts import render</span><br><span class="line"></span><br><span class="line">def index(request):</span><br><span class="line">    return render(request,&#x27;booktest/index.html&#x27;)</span><br></pre></td></tr></table></figure>

<p>9）在 <code>templates/booktest</code> 目录下创建文件 index.html，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;首页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>10）打开 <code>booktest/models.py</code> 文件，定义模型类 BookInfo 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from django.db import models</span><br><span class="line"></span><br><span class="line">class BookInfo(models.Model):</span><br><span class="line">    btitle = models.CharField(max_length=20, db_column=&#x27;title&#x27;)</span><br><span class="line">    bpub_date = models.DateField()</span><br><span class="line">    bread = models.IntegerField(default=0)</span><br><span class="line">    bcomment = models.IntegerField(default=0)</span><br><span class="line">    isDelete = models.BooleanField(default=False)</span><br></pre></td></tr></table></figure>

<h1 id="模板语言"><a href="#模板语言" class="headerlink" title="模板语言"></a>模板语言</h1><h2 id="模板变量"><a href="#模板变量" class="headerlink" title="模板变量"></a>模板变量</h2><p>模板变量的作用是计算并输出，变量名必须由字母、数字、下划线（不能以下划线开头）和点组成。</p>
<p>语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;变量&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>当模版引擎遇到点如 book.title，会按照下列顺序解析：</p>
<ol>
<li>字典 <code>book[&#39;title&#39;]</code> 。</li>
<li>先属性后方法，将 <code>book</code> 当作对象，查找属性 <code>title</code> ，如果没有再查找方法 <code>title()</code> 。</li>
<li>如果是格式为 <code>book.0</code> 则解析为列表 <code>book[0]</code> 。</li>
</ol>
<blockquote>
<p>如果变量不存在则插入空字符串’’。</p>
</blockquote>
<p>在模板中调用方法时不能传递参数。</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>1）打开 <code>booktest/views.py</code> 文件，创建视图 temp_var 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def temp_var(request):</span><br><span class="line">    dict=&#123;&#x27;title&#x27;:&#x27;字典键值&#x27;&#125;</span><br><span class="line">    book=BookInfo()</span><br><span class="line">    book.btitle=&#x27;对象属性&#x27;</span><br><span class="line">    context=&#123;&#x27;dict&#x27;:dict,&#x27;book&#x27;:book&#125;</span><br><span class="line">    return render(request,&#x27;booktest/temp_var.html&#x27;,context)</span><br></pre></td></tr></table></figure>

<p>2）打开 booktest&#x2F;urls.py 文件，配置 url。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^temp_var/$&#x27;, views.temp_var),</span><br></pre></td></tr></table></figure>

<p>3）修改在 <code>templates/booktest</code> 下创建 <code>temp_var.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;模板变量&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">模板变量：&lt;br/&gt;</span><br><span class="line">&#123;&#123; dic.title &#125;&#125; &lt;br/&gt;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">对象属性：</span><br><span class="line">&#123;&#123; book.btitle &#125;&#125; &lt;br/&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，在浏览器中输入如下网址，浏览效果如下图。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/temp_var/</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-21-43-31.png" class="">

<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><p>语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%代码段%&#125;</span><br></pre></td></tr></table></figure>

<p>for 标签语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;%for item in 列表%&#125;</span><br><span class="line">循环逻辑</span><br><span class="line">&#123;&#123;forloop.counter&#125;&#125;表示当前是第几次循环，从1开始</span><br><span class="line">&#123;%empty%&#125;</span><br><span class="line">列表为空或不存在时执行此逻辑</span><br><span class="line">&#123;%endfor%&#125;</span><br></pre></td></tr></table></figure>

<p>if 标签语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;%if ...%&#125;</span><br><span class="line">逻辑1</span><br><span class="line">&#123;%elif ...%&#125;</span><br><span class="line">逻辑2</span><br><span class="line">&#123;%else%&#125;</span><br><span class="line">逻辑3</span><br><span class="line">&#123;%endif%&#125;</span><br></pre></td></tr></table></figure>

<p>比较运算符如下：</p>
<blockquote>
<p>注意：运算符左右两侧不能紧挨变量或常量，必须有空格。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">==</span><br><span class="line">!=</span><br><span class="line">&lt;</span><br><span class="line">&gt;</span><br><span class="line">&lt;=</span><br><span class="line">&gt;=</span><br></pre></td></tr></table></figure>

<p>布尔运算符如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and</span><br><span class="line">or</span><br><span class="line">not</span><br></pre></td></tr></table></figure>

<p>点击查看<a target="_blank" rel="noopener" href="http://python.usyiyi.cn/translate/django_182/ref/templates/builtins.html">内建标签</a>了解更多标签，还有一些常用的标签会在后续地章节中讲解。</p>
<h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><p>1）打开 <code>booktest/views.py</code> 文件，创建视图 temp_tag 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from booktest.models import BookInfo</span><br><span class="line">def temp_tags(request):</span><br><span class="line">    context = &#123;&quot;list&quot;:BookInfo.objects.all()&#125;</span><br><span class="line">    return render(request, &#x27;booktest/temp_tags.html&#x27;, context)</span><br></pre></td></tr></table></figure>

<p>2）打开 <code>booktest/urls.py</code> 文件，配置 url 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^temp_tag/$&#x27;, views.temp_tags),</span><br></pre></td></tr></table></figure>

<p>3）在 <code>templates/booktest</code> 下创建 <code>temp_tag.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;标签&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">图书列表如下：</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &#123;% for book in list %&#125;</span><br><span class="line">        &#123;% if book.id &lt;= 2 %&#125;</span><br><span class="line">            &lt;li style=&quot;background-color: red&quot;&gt;&#123;&#123; book.btitle &#125;&#125;&lt;/li&gt;</span><br><span class="line">        &#123;% elif book.id &lt;= 4 %&#125;</span><br><span class="line">             &lt;li style=&quot;background-color: blue&quot;&gt;&#123;&#123; book.btitle &#125;&#125;&lt;/li&gt;</span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">             &lt;li style=&quot;background-color: greenyellow&quot;&gt;&#123;&#123; book.btitle &#125;&#125;&lt;/li&gt;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">        &#123;% empty %&#125;</span><br><span class="line">            &lt;li&gt;对不起，没有图书&lt;/li&gt;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，在浏览器中输入如下网址，浏览效果如下图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/temp_tags/</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-21-57-34.png" class="">

<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><p>语法如下:</p>
<ul>
<li>使用管道符号|来应用过滤器，用于进行计算、转换操作，可以使用在变量、标签中。</li>
<li>如果过滤器需要参数，则使用冒号:传递参数。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量|过滤器:参数</span><br></pre></td></tr></table></figure>

<p>长度 length ，返回字符串包含字符的个数，或列表、元组、字典的元素个数。</p>
<p>默认值 default，如果变量不存在时则返回默认值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data|default:&#x27;默认值&#x27;</span><br></pre></td></tr></table></figure>

<p>日期 date，用于对日期类型的值进行字符串格式化，常用的格式化字符如下：</p>
<ul>
<li>Y 表示年，格式为 4 位，y 表示两位的年。</li>
<li>m 表示月，格式为 01,02,12 等。</li>
<li>d 表示日, 格式为 01,02 等。</li>
<li>j 表示日，格式为 1,2 等。</li>
<li>H 表示时，24 进制，h 表示 12 进制的时。</li>
<li>i 表示分，为 0-59。</li>
<li>s 表示秒，为 0-59。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value|date:&quot;Y年m月j日  H时i分s秒&quot;</span><br></pre></td></tr></table></figure>

<p>点击查看<a target="_blank" rel="noopener" href="http://python.usyiyi.cn/translate/django_182/ref/templates/builtins.html">内建过滤器</a>了解更多过滤器。</p>
<h3 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h3><p>1）打开 <code>booktest/views.py</code> 文件，创建视图 temp_filter 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def temp_filter(request):</span><br><span class="line">    context=&#123;&#x27;list&#x27;:BookInfo.objects.all()&#125;</span><br><span class="line">    return render(request,&#x27;booktest/temp_filter.html&#x27;,context)</span><br></pre></td></tr></table></figure>

<p>2）打开 <code>booktest/urls.py</code> 文件，配置 <code>url</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^temp_filter/$&#x27;, views.temp_filter),</span><br></pre></td></tr></table></figure>

<p>3）在 <code>templates/booktest</code>下创建 <code>temp_filter.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;过滤器&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">图书列表如下：</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &#123;%for book in list%&#125;</span><br><span class="line">        &#123;%if book.btitle|length &gt; 4%&#125;</span><br><span class="line">            &lt;li style=&quot;background-color: red;&quot;&gt;</span><br><span class="line">                &#123;&#123;book.btitle&#125;&#125;</span><br><span class="line">                ---默认时间格式为：</span><br><span class="line">                &#123;&#123;book.bpub_date&#125;&#125;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">        &#123;%else%&#125;</span><br><span class="line">            &lt;li style=&quot;background-color: green;&quot;&gt;</span><br><span class="line">                &#123;&#123;book.btitle&#125;&#125;</span><br><span class="line">                ---格式化时间为：</span><br><span class="line">                &#123;&#123;book.bpub_date|date:&quot;Y-m-j&quot;&#125;&#125;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line">        &#123;%endif%&#125;</span><br><span class="line">    &#123;%endfor%&#125;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，在浏览器中输入如下网址，浏览效果如下图：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/temp_filter/</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-10-03.png" class="">

<h2 id="自定义过滤器"><a href="#自定义过滤器" class="headerlink" title="自定义过滤器"></a>自定义过滤器</h2><p>过滤器就是 python 中的函数，注册后就可以在模板中当作过滤器使用，下面以求余为例开发一个自定义过滤器 mod 。</p>
<h3 id="示例-3"><a href="#示例-3" class="headerlink" title="示例"></a>示例</h3><p>1）在应用中创建 templatetags 目录，当前示例为 <code>booktest/templatetags</code> ，创建 <code>__init__.py</code> 文件，内容为空。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-12-48.png" class="">

<p>2）在 <code>booktest/templatetags</code> 目录下创建 <code>filters.py</code>文件，代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#导入Library类</span><br><span class="line">from django.template import Library</span><br><span class="line"></span><br><span class="line">#创建一个Library类对象</span><br><span class="line">register=Library()</span><br><span class="line"></span><br><span class="line">#使用装饰器进行注册</span><br><span class="line">@register.filter</span><br><span class="line">#定义求余函数mod，将value对2求余</span><br><span class="line">def mod(value):</span><br><span class="line">    return value%2 == 0</span><br></pre></td></tr></table></figure>

<p>3）在 templates&#x2F;booktest&#x2F;temp_filter.html 中，使用自定义过滤器。</p>
<ul>
<li>首先使用 load 标签引入模块。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%load filters%&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>在遍历时添加如下代码：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elif book.id|mod %&#125;</span><br><span class="line">    &lt;li style=&quot;background-color: yellow&quot;&gt;</span><br><span class="line">    &#123;&#123; book.btitle &#125;&#125;</span><br><span class="line">    ---默认时间格式</span><br><span class="line">    &#123;&#123; book.bpub_date &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，浏览效果如下：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-20-04.png" class="">

<p>过滤器可以接收参数，将 <code>booktest/templatetags/filters.py</code> 中增加 mod_num 函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#使用装饰器进行注册</span><br><span class="line">@register.filter</span><br><span class="line">#定义求余函数mod_num，将value对num求余</span><br><span class="line">def mod_num(value,num):</span><br><span class="line">    return value%num</span><br></pre></td></tr></table></figure>

<p>5）在 <code>templates/booktest/temp_filter.html</code> 中修改遍历时判断代码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elif book.id|mod_num:3 %&#125;</span><br><span class="line">    &lt;li style=&quot;background-color: cornflowerblue&quot;&gt;</span><br><span class="line">    &#123;&#123; book.btitle &#125;&#125;</span><br><span class="line">    ---默认时间格式</span><br><span class="line">    &#123;&#123; book.bpub_date &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>6）运行服务器，浏览效果如下：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-24-29.png" class="">

<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>在模板中使用如下模板注释，这段代码不会被编译，不会输出到客户端；html 注释只能注释 html 内容，不能注释模板语言。</p>
<p>1）单行注释语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;#...#&#125;</span><br></pre></td></tr></table></figure>

<p>注释可以包含任何模版代码，有效的或者无效的都可以。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;# &#123; % if foo % &#125;bar&#123; % else % &#125; #&#125;</span><br></pre></td></tr></table></figure>

<p>2）多行注释使用 comment 标签，语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;%comment%&#125;</span><br><span class="line">...</span><br><span class="line">&#123;%endcomment%&#125;</span><br></pre></td></tr></table></figure>

<h1 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h1><p>模板继承和类的继承含义是一样的，主要是为了提高代码重用，减轻开发人员的工作量。</p>
<p><strong>典型应用：网站的头部、尾部信息。</strong></p>
<h2 id="父模板"><a href="#父模板" class="headerlink" title="父模板"></a>父模板</h2><p>如果发现在多个模板中某些内容相同，那就应该把这段内容定义到父模板中。</p>
<p><code>标签 block</code> ：用于在父模板中预留区域，留给子模板填充差异性的内容，名字不能相同。 为了更好的可读性，建议给 endblock 标签写上名字，这个名字与对应的 block 名字相同。父模板中也可以使用上下文中传递过来的数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;%block 名称%&#125;</span><br><span class="line">预留区域，可以编写默认内容，也可以没有默认内容</span><br><span class="line">&#123;%endblock  名称%&#125;</span><br></pre></td></tr></table></figure>

<h2 id="子模板"><a href="#子模板" class="headerlink" title="子模板"></a>子模板</h2><p><code>标签 extends</code> ：继承，写在子模板文件的第一行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% extends &quot;父模板路径&quot;%&#125;</span><br></pre></td></tr></table></figure>

<p>子模版不用填充父模版中的所有预留区域，如果子模版没有填充，则使用父模版定义的默认值。</p>
<p>填充父模板中指定名称的预留区域。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;%block 名称%&#125;</span><br><span class="line">实际填充内容</span><br><span class="line">&#123;&#123;block.super&#125;&#125;用于获取父模板中block的内容</span><br><span class="line">&#123;%endblock 名称%&#125;</span><br></pre></td></tr></table></figure>

<h3 id="示例-4"><a href="#示例-4" class="headerlink" title="示例"></a>示例</h3><p>1）打开 <code>booktest/views.py</code> 文件，创建视图 temp_inherit 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def temp_inherit(request):</span><br><span class="line">    context=&#123;&#x27;title&#x27;:&#x27;模板继承&#x27;,&#x27;list&#x27;:BookInfo.objects.all()&#125;</span><br><span class="line">    return render(request,&#x27;booktest/temp_inherit.html&#x27;,context)</span><br></pre></td></tr></table></figure>

<p>2）打开 <code>booktest/urls.py</code> 文件，配置 url 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^temp_inherit/$&#x27;, views.temp_inherit),</span><br></pre></td></tr></table></figure>

<p>3）在 templates 下创建 <code>inherit_base.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;&#123;&#123;title&#125;&#125;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;这是头&lt;/h2&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&#123;%block qu1%&#125;</span><br><span class="line">这是区域一，有默认值</span><br><span class="line">&#123;%endblock qu1%&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&#123;%block qu2%&#125;</span><br><span class="line">&#123;%endblock qu2%&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;h2&gt;这是尾&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）在 <code>templates/booktest</code> 下创建 <code>temp_inherit.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;%extends &#x27;booktest/inherit_base.html&#x27;%&#125;</span><br><span class="line">&#123;%block qu2%&#125;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &#123;%for book in list%&#125;</span><br><span class="line">    &lt;li&gt;&#123;&#123;book.btitle&#125;&#125;&lt;/li&gt;</span><br><span class="line">    &#123;%endfor%&#125;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line">&#123;%endblock qu2%&#125;</span><br></pre></td></tr></table></figure>

<p>5）运行服务器，在浏览器中输入如下网址,浏览效果如下图。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/temp_inherit/</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-04-22-34-10.png" class="">

<h2 id="HTML-转义"><a href="#HTML-转义" class="headerlink" title="HTML 转义"></a>HTML 转义</h2><p>模板对上下文传递的字符串进行输出时，会对以下字符自动转义。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">小于号&lt; 转换为 &amp;lt;</span><br><span class="line"></span><br><span class="line">大于号&gt; 转换为 &amp;gt;</span><br><span class="line"></span><br><span class="line">单引号&#x27; 转换为 &amp;#39;</span><br><span class="line"></span><br><span class="line">双引号&quot; 转换为 &amp;quot;</span><br><span class="line"></span><br><span class="line">与符号&amp; 转换为 &amp;amp;</span><br></pre></td></tr></table></figure>

<h3 id="示例-5"><a href="#示例-5" class="headerlink" title="示例"></a>示例</h3><p>1）打开 <code>booktest/views.py</code> 文件，创建视图 html_escape 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def html_escape(request):</span><br><span class="line">    context=&#123;&#x27;content&#x27;:&#x27;&lt;h1&gt;hello world&lt;/h1&gt;&#x27;&#125;</span><br><span class="line">    return render(request,&#x27;booktest/html_escape.html&#x27;,context)</span><br></pre></td></tr></table></figure>

<p>2）打开 <code>booktest/urls.py</code> 文件，配置 url 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^html_escape/$&#x27;, views.html_escape),</span><br></pre></td></tr></table></figure>

<p>3）在 <code>templates/booktest/</code> 目录下创建 <code>html_escape.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;转义&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">自动转义：&#123;&#123;content&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，在浏览器中输入如下网址。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/html_escape/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>转义后标记代码不会被直接解释执行，而是被直接呈现，防止客户端通过嵌入 js 代码攻击网站.</p>
</blockquote>
<p>浏览效果如下图:</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-02-15.png" class="">

<h2 id="关闭转义"><a href="#关闭转义" class="headerlink" title="关闭转义"></a>关闭转义</h2><p>过滤器 <code>escape</code> 可以实现对变量的 html 转义，默认模板就会转义，一般省略。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;t1|escape&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>过滤器 <code>safe</code>：禁用转义，告诉模板这个变量是安全的，可以解释执行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;data|safe&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>1）修改 templates&#x2F;booktest&#x2F;html_escape.html 代码如下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;转义&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">自动转义：&#123;&#123;content&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">过滤器safe关闭转义：&#123;&#123;content|safe&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-07-07.png" class="">

<p>标签 <code>autoescape</code> ：设置一段代码都禁用转义，接受 on、off 参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;% autoescape off %&#125;</span><br><span class="line">...</span><br><span class="line">&#123;% endautoescape %&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>1）修改 <code>templates/booktest/html_escape.html</code> 代码如下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;转义&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">自动转义：&#123;&#123;content&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">过滤器safe关闭转义：&#123;&#123;content|safe&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">标签autoescape关闭转义：</span><br><span class="line">&#123;%autoescape off%&#125;</span><br><span class="line">&#123;&#123;content&#125;&#125;</span><br><span class="line">&#123;%endautoescape%&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>刷新浏览器后效果如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-11-53.png" class="">

<h2 id="字符串字面值"><a href="#字符串字面值" class="headerlink" title="字符串字面值"></a>字符串字面值</h2><p>对于在模板中硬编码的 html 字符串，不会转义。</p>
<p>1）修改 <code>templates/booktest/html_escape.html</code> 代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;转义&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">自动转义：&#123;&#123;content&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">过滤器safe关闭转义：&#123;&#123;content|safe&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">标签autoescape关闭转义：</span><br><span class="line">&#123;%autoescape off%&#125;</span><br><span class="line">&#123;&#123;content&#125;&#125;</span><br><span class="line">&#123;%endautoescape%&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">模板硬编码不转义：&#123;&#123;data|default:&#x27;&lt;h1&gt;hello&lt;/h1&gt;&#x27;&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>2）刷新浏览器后效果如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-14-39.png" class="">

<p>如果希望出现转义的效果，则需要手动编码转义。</p>
<p>1）修改 templates&#x2F;booktest&#x2F;html_escape.html 代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;转义&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">自动转义：&#123;&#123;content&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">过滤器safe关闭转义：&#123;&#123;content|safe&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">标签autoescape关闭转义：</span><br><span class="line">&#123;%autoescape off%&#125;</span><br><span class="line">&#123;&#123;content&#125;&#125;</span><br><span class="line">&#123;%endautoescape%&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">模板硬编码不转义：&#123;&#123;data|default:&#x27;&lt;h1&gt;hello&lt;/h1&gt;&#x27;&#125;&#125;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">模板硬编码手动转义：&#123;&#123;data|default:&quot;&amp;lt;h1&amp;gt;123&amp;lt;/h1&amp;gt;&quot;&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>2）刷新浏览器后效果如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-16-22.png" class="">

<h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><p>CSRF 全拼为 <code>Cross Site Request Forgery</code> ，译为跨站请求伪造。CSRF 指攻击者盗用了你的身份，以你的名义发送恶意请求。</p>
<p>CSRF 示意图如下：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-11-17-40.png" class="">

<p>如果想防止 CSRF ，首先是重要的信息传递都采用 POST 方式而不是 GET 方式，接下来就说 POST 请求的攻击方式以及在 Django 中的避免。</p>
<h2 id="示例-6"><a href="#示例-6" class="headerlink" title="示例"></a>示例</h2><p>攻击过程的操作了解即可，不需要重现。</p>
<p>1）打开 <code>booktest/views.py</code> 文件，创建视图 login ， login_check , post 和 post_action 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">def login(reqeust):</span><br><span class="line">    return render(reqeust, &#x27;booktest/login.html&#x27;)</span><br><span class="line"></span><br><span class="line">def login_check(request):</span><br><span class="line">    username = request.POST.get(&#x27;username&#x27;) #获取用户名</span><br><span class="line">    password = request.POST.get(&#x27;password&#x27;) #获取密码</span><br><span class="line"></span><br><span class="line">    # 校验</span><br><span class="line">    if username == &#x27;smart&#x27; and password == &#x27;123&#x27;:</span><br><span class="line">        request.session[&#x27;username&#x27;]=name #记住登录用户名</span><br><span class="line">        request.session[&#x27;islogin&#x27;]=True　#判断用户是否已登录</span><br><span class="line">        return redirect(&#x27;/post/&#x27;)</span><br><span class="line">    else:</span><br><span class="line">        return redirect(&#x27;／login/&#x27;)</span><br><span class="line"></span><br><span class="line">def post(request):</span><br><span class="line">    return render(request, &#x27;booktest/post.html&#x27;)</span><br><span class="line"></span><br><span class="line">def post_action(request):</span><br><span class="line">    if request.session[&#x27;islogin&#x27;]:</span><br><span class="line">        username = request.session[&#x27;username&#x27;]</span><br><span class="line">        return HttpResponse(&#x27;用户&#x27;+username+&#x27;发了一篇帖子&#x27;)</span><br><span class="line">    else:</span><br><span class="line">        return HttpResponse(&#x27;发帖失败&#x27;)</span><br></pre></td></tr></table></figure>

<p>2）打开 booktest&#x2F;urls.py 文件，配置 url。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^login/$&#x27;, views.login),</span><br><span class="line">url(r&#x27;^login_check/$&#x27;, views.login_check),</span><br><span class="line">url(r&#x27;^post/$&#x27;, views.post),</span><br><span class="line">url(r&#x27;^post_action/$&#x27;,views.post_action),</span><br></pre></td></tr></table></figure>

<p>3）在 <code>templates/booktest/</code> 目录下创建 <code>login.html</code> 和 <code>post.html</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">login.html</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;登录案例&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;/login_check/&quot;&gt;</span><br><span class="line">    用户名：&lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;&lt;br/&gt;</span><br><span class="line">    密码：&lt;input type=&quot;password&quot; name=&quot;password&quot;/&gt;&lt;br/&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">post.html</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;发帖页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;/post_action/&quot;&gt;</span><br><span class="line">    标题:&lt;input type=&quot;text&quot; name=&quot;title&quot;/&gt;&lt;br/&gt;</span><br><span class="line">    内容:&lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;发帖&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）启动运行服务器，采用 IP 的方式，因为要演示其它 IP 的请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 manage.py runserver 192.168.141.130:8000</span><br></pre></td></tr></table></figure>

<p>5）回到 windows 中，在浏览器中输入如下网址，将这个标签称为网站 A。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/post/</span><br></pre></td></tr></table></figure>

<p>浏览效果如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-08-38.png" class="">

<p>输入用户名和密码，点击登录，效果如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-09-09.png" class="">

<p>6）下面使用 windows 中使用 Django 模拟一个网站，创建 <code>post.html</code>，复制 <code>templates/booktest/post.html</code> 内容，并修改 <code>action</code> 路径。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;发帖页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;http://192.168.141.130:8000/post_action/&quot;&gt;</span><br><span class="line">  标题:&lt;input type=&quot;text&quot; name=&quot;title&quot;/&gt;&lt;br/&gt;</span><br><span class="line">  内容:&lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">  &lt;input type=&quot;submit&quot; value=&quot;发帖&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>7）在 windows 中浏览器查看效果如下图，将这个标签称为网站 B。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-12-25.png" class="">

<p>8）Django 项目中默认启用了 csrf 保护，现在先禁用，打开 <code>test4/settings.py</code> 文件，注释掉 csrf 中间件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE_CLASSES = (</span><br><span class="line">    &#x27;django.contrib.sessions.middleware.SessionMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.common.CommonMiddleware&#x27;,</span><br><span class="line">    # &#x27;django.middleware.csrf.CsrfViewMiddleware&#x27;,# 禁用</span><br><span class="line">    &#x27;django.contrib.auth.middleware.AuthenticationMiddleware&#x27;,</span><br><span class="line">    &#x27;django.contrib.auth.middleware.SessionAuthenticationMiddleware&#x27;,</span><br><span class="line">    &#x27;django.contrib.messages.middleware.MessageMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.clickjacking.XFrameOptionsMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.security.SecurityMiddleware&#x27;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>9）点击游览器的第一个标签即网站 A，点击”发帖”按钮后如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-14-10.png" class="">

<p>10）点击游览器的第二个标签即 IIS 网站 B，点击“发帖”按钮后如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-14-52.png" class="">

<p>对比上面两张图，发现无论从网站 A 还是网站 B 都可以访问网站 A 的 post_action 视图，这就是不安全的。</p>
<h2 id="防止-CSRF"><a href="#防止-CSRF" class="headerlink" title="防止 CSRF"></a>防止 CSRF</h2><p>1）Django 提供了 csrf 中间件用于防止 CSRF 攻击，只需要在 <code>test4/settings.py</code> 中启用 csrf 中间件即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE_CLASSES = (</span><br><span class="line">    &#x27;django.contrib.sessions.middleware.SessionMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.common.CommonMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.csrf.CsrfViewMiddleware&#x27;, # 启用csrf中间件</span><br><span class="line">    &#x27;django.contrib.auth.middleware.AuthenticationMiddleware&#x27;,</span><br><span class="line">    &#x27;django.contrib.auth.middleware.SessionAuthenticationMiddleware&#x27;,</span><br><span class="line">    &#x27;django.contrib.messages.middleware.MessageMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.clickjacking.XFrameOptionsMiddleware&#x27;,</span><br><span class="line">    &#x27;django.middleware.security.SecurityMiddleware&#x27;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>2）回到 windows 浏览器中，分别在网站 A、网站 B 中点击“提交”按钮，效果一样，如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-18-52.png" class="">

<p>3）接下来 <code>templates/booktest/post.html</code>内容，在 form 表单中使用标签 <code>csrf_token</code> 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;发帖页&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;/post_action/&quot;&gt;</span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    标题:&lt;input type=&quot;text&quot; name=&quot;title&quot;/&gt;&lt;br/&gt;</span><br><span class="line">    内容:&lt;textarea name=&quot;content&quot;&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;发帖&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）回到 windows 浏览器中，在网站 A 中点击“提交”按钮，效果如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-24-25.png" class="">

<p>好了，Django 中成功完成 CSRF 防护。</p>
<h2 id="保护原理"><a href="#保护原理" class="headerlink" title="保护原理"></a>保护原理</h2><p>加入标签后，可以查看 post.html 的源代码，发现多了一个隐藏域。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-50-30.png" class="">

<p>在浏览器的“开发者工具”中查看 cookie 信息。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-05-23-51-13.png" class="">

<p>说明：当启用中间件并加入标签 csrf_token 后，会向客户端浏览器中写入一条 Cookie 信息，这条信息的值与隐藏域 input 元素的 value 属性是一致的，提交到服务器后会先由 csrf 中间件进行验证，如果对比失败则返回 403 页面，而不会进行后续的处理。</p>
<h1 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h1><h2 id="手动实现验证码"><a href="#手动实现验证码" class="headerlink" title="手动实现验证码"></a>手动实现验证码</h2><p>1）安装包 Pillow3.4.1。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Pillow</span><br></pre></td></tr></table></figure>

<p>点击查看<a target="_blank" rel="noopener" href="http://pillow.readthedocs.io/en/3.4.x/">PIL 模块 API</a>，以下代码中用到了 Image、ImageDraw、ImageFont 对象及方法。</p>
<p>2）在 booktest&#x2F;views.py 文件中，创建视图 verify_code。</p>
<ul>
<li>提示 1：随机生成字符串后存入 session 中，用于后续判断。</li>
<li>提示 2：视图返回 mime-type 为 image&#x2F;png。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image, ImageDraw, ImageFont</span><br><span class="line">from django.utils.six import BytesIO</span><br><span class="line">...</span><br><span class="line">def verify_code(request):</span><br><span class="line">    #引入随机函数模块</span><br><span class="line">    import random</span><br><span class="line">    #定义变量，用于画面的背景色、宽、高</span><br><span class="line">    bgcolor = (random.randrange(20, 100), random.randrange(</span><br><span class="line">        20, 100), 255)</span><br><span class="line">    width = 100</span><br><span class="line">    height = 25</span><br><span class="line">    #创建画面对象</span><br><span class="line">    im = Image.new(&#x27;RGB&#x27;, (width, height), bgcolor)</span><br><span class="line">    #创建画笔对象</span><br><span class="line">    draw = ImageDraw.Draw(im)</span><br><span class="line">    #调用画笔的point()函数绘制噪点</span><br><span class="line">    for i in range(0, 100):</span><br><span class="line">        xy = (random.randrange(0, width), random.randrange(0, height))</span><br><span class="line">        fill = (random.randrange(0, 255), 255, random.randrange(0, 255))</span><br><span class="line">        draw.point(xy, fill=fill)</span><br><span class="line">    #定义验证码的备选值</span><br><span class="line">    str1 = &#x27;ABCD123EFGHIJK456LMNOPQRS789TUVWXYZ0&#x27;</span><br><span class="line">    #随机选取4个值作为验证码</span><br><span class="line">    rand_str = &#x27;&#x27;</span><br><span class="line">    for i in range(0, 4):</span><br><span class="line">        rand_str += str1[random.randrange(0, len(str1))]</span><br><span class="line">    #构造字体对象，ubuntu的字体路径为“/usr/share/fonts/truetype/freefont”</span><br><span class="line">    font = ImageFont.truetype(&#x27;FreeMono.ttf&#x27;, 23)</span><br><span class="line">    #构造字体颜色</span><br><span class="line">    fontcolor = (255, random.randrange(0, 255), random.randrange(0, 255))</span><br><span class="line">    #绘制4个字</span><br><span class="line">    draw.text((5, 2), rand_str[0], font=font, fill=fontcolor)</span><br><span class="line">    draw.text((25, 2), rand_str[1], font=font, fill=fontcolor)</span><br><span class="line">    draw.text((50, 2), rand_str[2], font=font, fill=fontcolor)</span><br><span class="line">    draw.text((75, 2), rand_str[3], font=font, fill=fontcolor)</span><br><span class="line">    #释放画笔</span><br><span class="line">    del draw</span><br><span class="line">    #存入session，用于做进一步验证</span><br><span class="line">    request.session[&#x27;verifycode&#x27;] = rand_str</span><br><span class="line">    #内存文件操作</span><br><span class="line">    buf = BytesIO()</span><br><span class="line">    #将图片保存在内存中，文件类型为png</span><br><span class="line">    im.save(buf, &#x27;png&#x27;)</span><br><span class="line">    #将内存中的图片数据返回给客户端，MIME类型为图片png</span><br><span class="line">    return HttpResponse(buf.getvalue(), &#x27;image/png&#x27;)</span><br></pre></td></tr></table></figure>

<p>3）打开 booktest&#x2F;urls.py 文件，配置 url。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^verify_code/$&#x27;, views.verify_code),</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，在浏览器中输入如下网址，效果图如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/verify_code/</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-06-23-39-53.png" class="">

<h2 id="调用验证码"><a href="#调用验证码" class="headerlink" title="调用验证码"></a>调用验证码</h2><p>1）在 booktest&#x2F;views.py 文件中，创建视图 verify_show。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def verify_show(request):</span><br><span class="line">    return render(request,&#x27;booktest/verify_show.html&#x27;)</span><br></pre></td></tr></table></figure>

<p>2）打开 booktest&#x2F;urls.py 文件，配置 url。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^verify_show/$&#x27;, views.verify_show),</span><br></pre></td></tr></table></figure>

<p>3）在 templates&#x2F;booktest&#x2F;目录下创建 verify_show.html。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;验证码&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;/verify_yz/&quot;&gt;</span><br><span class="line">    &#123;%csrf_token%&#125;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;yzm&quot;&gt;</span><br><span class="line">    &lt;img id=&quot;yzm&quot; src=&quot;/verify_code/&quot;/&gt;</span><br><span class="line">    &lt;span id=&quot;change&quot;&gt;看不清，换一个&lt;/span&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）运行服务器，在浏览器中输入如下网址,效果图如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/verify_show/</span><br></pre></td></tr></table></figure>

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-06-23-54-38.png" class="">

<h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p>1）在 booktest&#x2F;views.py 文件中，创建视图 verify_yz。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def verify_yz(request):</span><br><span class="line">    yzm = request.POST.get(&#x27;yanzhengma&#x27;)</span><br><span class="line">    verifycode = request.session[&#x27;verifycode&#x27;]</span><br><span class="line">    response = HttpResponse(yzm + &quot; &quot; + verifycode)</span><br><span class="line"></span><br><span class="line">    if yzm.upper() == verifycode.upper():</span><br><span class="line">        response = HttpResponse(&#x27;OK&#x27;)</span><br><span class="line">    return response</span><br></pre></td></tr></table></figure>

<p>2）打开 booktest&#x2F;urls.py 文件，配置 url。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^verify_yz/$&#x27;, views.verify_yz),</span><br></pre></td></tr></table></figure>

<p>3）回到浏览器后刷新，在文本框中填写验证码，点击提交按钮。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-00-32-11.png" class="">

<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-00-32-32.png" class="">

<h1 id="反向解析"><a href="#反向解析" class="headerlink" title="反向解析"></a>反向解析</h1><p>反向解析应用在两个地方：模板中的超链接，视图中的重定向。</p>
<h2 id="示例-7"><a href="#示例-7" class="headerlink" title="示例"></a>示例</h2><p>1）在 <code>test4/urls.py</code> 中为 include 定义 namespace 属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^&#x27;,include(&#x27;booktest.urls&#x27;,namespace=&#x27;booktest&#x27;)),</span><br></pre></td></tr></table></figure>

<p>2）在 <code>booktest/urls.py</code> 中为 url 定义 name 属性，并修改为 fan2。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^fan2/$&#x27;, views.fan2,name=&#x27;fan2&#x27;),</span><br></pre></td></tr></table></figure>

<p>3）在模板中使用 url 标签做超链接，此处为 <code>templates/booktest/fan1.html</code> 文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;反向解析&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">普通链接：&lt;a href=&quot;/fan2/&quot;&gt;fan2&lt;/a&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">反向解析：&lt;a href=&quot;&#123;%url &#x27;booktest:fan2&#x27;%&#125;&quot;&gt;fan2&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）回到浏览器中，后退，刷新，查看源文件如下图，两个链接地址一样。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-22-58-53.png" class="">

<p>5）在 <code>booktest/urls.py</code> 中，将 fan2 修改为 fan_show 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^fan_show/$&#x27;, views.fan2,name=&#x27;fan2&#x27;),</span><br></pre></td></tr></table></figure>

<p>6）回到浏览器中，刷新，查看源文件如下图，两个链接地址不一样。</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-23-00-17.png" class="">

<p>7）反向解析也可以应用在视图的重定向中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from django.shortcuts import redirect</span><br><span class="line">from django.core.urlresolvers import reverse</span><br><span class="line"></span><br><span class="line">return redirect(reverse(&#x27;booktest:fan2&#x27;))</span><br></pre></td></tr></table></figure>

<p>总结：在定义 url 时，需要为 include 定义 namespace 属性，为 url 定义 name 属性，使用时，在模板中使用 url 标签，在视图中使用 reverse 函数，根据正则表达式动态生成地址，减轻后期维护成本。</p>
<h2 id="URL-的参数"><a href="#URL-的参数" class="headerlink" title="URL 的参数"></a>URL 的参数</h2><p>有些 url 配置项正则表达式中是有参数的，接下来讲解如何传递参数。</p>
<h3 id="情况一：位置参数"><a href="#情况一：位置参数" class="headerlink" title="情况一：位置参数"></a>情况一：位置参数</h3><p>1）在 <code>booktest/urls.py</code> 中，添加 fan3 如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^fan(\d+)_(\d+)/$&#x27;, views.fan3,name=&#x27;fan3&#x27;),</span><br></pre></td></tr></table></figure>

<p>2）在 <code>booktest/views</code>中，定义视图 fan3 如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def fan3(request, a, b):</span><br><span class="line">    return HttpResponse(a+b)</span><br></pre></td></tr></table></figure>

<p>3）修改 <code>templates/booktest/fan1.html</code> 文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;反向解析&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">普通连接：&lt;a href=&quot;/fan2/&quot;&gt;fan2&lt;/a&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">反向解析：&lt;a href=&quot;&#123;% url &#x27;booktest:fan2&#x27; %&#125;&quot;&gt;fan2&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">位置参数：&lt;a href=&quot;&#123;% url &#x27;booktest:fan3&#x27; 1 3 %&#125;&quot;&gt;fan3&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）回到浏览器中，刷新，查看源文件如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-23-14-32.png" class="">

<p>使用重定向传递位置参数格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return redirect(reverse(&#x27;booktest:fan3&#x27;, args=(2,3)))</span><br></pre></td></tr></table></figure>

<h3 id="情况二：关键字参数"><a href="#情况二：关键字参数" class="headerlink" title="情况二：关键字参数"></a>情况二：关键字参数</h3><p>1）在 <code>booktest/urls.py</code> 中，修改 fan2 如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url(r&#x27;^fan(?P&lt;id&gt;\d+)_(?P&lt;age&gt;\d+)/$&#x27;, views.fan4,name=&#x27;fan2&#x27;),</span><br></pre></td></tr></table></figure>

<p>2）在 <code>booktest/views</code> 中，定义视图 fan4 如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def fan4(request, id, age):</span><br><span class="line">    return HttpResponse(id+age)</span><br></pre></td></tr></table></figure>

<p>3）修改 <code>templates/booktest/fan1.html</code> 文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;反向解析&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">普通连接：&lt;a href=&quot;/fan2/&quot;&gt;fan2&lt;/a&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">反向解析：&lt;a href=&quot;&#123;% url &#x27;booktest:fan2&#x27; %&#125;&quot;&gt;fan2&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">位置参数：&lt;a href=&quot;&#123;% url &#x27;booktest:fan3&#x27; 1 3 %&#125;&quot;&gt;fan3&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr&gt;</span><br><span class="line">关键字参数&lt;a href=&quot;&#123;% url &#x27;booktest:fan4&#x27; id=1 age=23 %&#125;&quot;&gt;fan4&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>4）回到浏览器中，刷新，查看源文件如下图：</p>
<img src="/2020/01/04/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E6%9D%BF/2020-01-07-23-19-25.png" class="">

<p>使用重定向传递关键字参数格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return redirect(reverse(&#x27;booktest:fan4&#x27;, kwargs=&#123;&#x27;id&#x27;:100,&#x27;age&#x27;:18&#125;))</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Django/" rel="tag"># Django</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/12/31/Python-%E5%BA%93%E6%89%93%E5%8C%85%E5%88%86%E5%8F%91-setup-py-%E7%BC%96%E5%86%99-%E7%AE%80%E6%98%93%E6%8C%87%E5%8D%97/" rel="prev" title="Python 库打包分发(setup.py 编写)简易指南">
                  <i class="fa fa-chevron-left"></i> Python 库打包分发(setup.py 编写)简易指南
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/01/15/Django%E5%AD%A6%E4%B9%A0-%E5%85%B6%E4%BB%96/" rel="next" title="Django学习-其他">
                  Django学习-其他 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CKCat</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/CKCat" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
