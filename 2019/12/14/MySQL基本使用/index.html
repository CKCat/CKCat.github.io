<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"ckcat.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="推荐使用 mycli 操作 MySQL 数据库.  MySQL 使用基本操作命令行连接 1$ mysql -uroot -p #回车后输入密码。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基本使用">
<meta property="og:url" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="CKCat的博客">
<meta property="og:description" content="推荐使用 mycli 操作 MySQL 数据库.  MySQL 使用基本操作命令行连接 1$ mysql -uroot -p #回车后输入密码。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-15-16-32-28.png">
<meta property="og:image" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-12-55-40.png">
<meta property="og:image" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-12-55-57.png">
<meta property="og:image" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-12-56-06.png">
<meta property="og:image" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-22-07-15.png">
<meta property="article:published_time" content="2019-12-14T22:52:45.000Z">
<meta property="article:modified_time" content="2023-09-06T02:09:37.423Z">
<meta property="article:author" content="CKCat">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-15-16-32-28.png">


<link rel="canonical" href="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","path":"2019/12/14/MySQL基本使用/","title":"MySQL基本使用"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MySQL基本使用 | CKCat的博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">CKCat的博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL-%E4%BD%BF%E7%94%A8"><span class="nav-number">1.</span> <span class="nav-text">MySQL 使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.</span> <span class="nav-text">基本操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="nav-number">1.2.</span> <span class="nav-text">数据库操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.</span> <span class="nav-text">数据表操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="nav-number">1.4.</span> <span class="nav-text">增删改查</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D"><span class="nav-number">1.5.</span> <span class="nav-text">数据库备份和恢复</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="nav-number">2.</span> <span class="nav-text">数据库设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="nav-number">2.1.</span> <span class="nav-text">三范式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#E-R-%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.2.</span> <span class="nav-text">E-R 模型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">更多查询用法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6"><span class="nav-number">3.1.</span> <span class="nav-text">条件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">3.2.</span> <span class="nav-text">比较运算符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="nav-number">3.3.</span> <span class="nav-text">逻辑运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.4.</span> <span class="nav-text">模糊查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.5.</span> <span class="nav-text">范围查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E5%88%A4%E6%96%AD"><span class="nav-number">3.6.</span> <span class="nav-text">空判断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E5%85%88%E7%BA%A7"><span class="nav-number">3.7.</span> <span class="nav-text">优先级</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">3.8.</span> <span class="nav-text">排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="nav-number">3.9.</span> <span class="nav-text">聚合函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E7%BB%84"><span class="nav-number">3.10.</span> <span class="nav-text">分组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E9%A1%B5"><span class="nav-number">3.11.</span> <span class="nav-text">分页</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.12.</span> <span class="nav-text">连接查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%85%B3%E8%81%94"><span class="nav-number">3.13.</span> <span class="nav-text">自关联</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">3.14.</span> <span class="nav-text">子查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">3.15.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySql-%E9%AB%98%E7%BA%A7"><span class="nav-number">4.</span> <span class="nav-text">MySql 高级</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">4.1.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">4.1.1.</span> <span class="nav-text">视图是什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E8%A7%86%E5%9B%BE"><span class="nav-number">4.1.2.</span> <span class="nav-text">定义视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%A7%86%E5%9B%BE"><span class="nav-number">4.1.3.</span> <span class="nav-text">查看视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%86%E5%9B%BE"><span class="nav-number">4.1.4.</span> <span class="nav-text">使用视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="nav-number">4.1.5.</span> <span class="nav-text">删除视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">4.1.6.</span> <span class="nav-text">视图的作用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">4.2.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7-%E7%AE%80%E7%A7%B0-ACID"><span class="nav-number">4.2.1.</span> <span class="nav-text">事务四大特性(简称 ACID)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%AD%90%E6%80%A7-Atomicity"><span class="nav-number">4.2.1.1.</span> <span class="nav-text">原子性(Atomicity)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E8%87%B4%E6%80%A7-Consistency"><span class="nav-number">4.2.1.2.</span> <span class="nav-text">一致性(Consistency)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%94%E7%A6%BB%E6%80%A7-Isolation"><span class="nav-number">4.2.1.3.</span> <span class="nav-text">隔离性(Isolation)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%81%E4%B9%85%E6%80%A7-Durability"><span class="nav-number">4.2.1.4.</span> <span class="nav-text">持久性(Durability)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E5%91%BD%E4%BB%A4"><span class="nav-number">4.2.2.</span> <span class="nav-text">事务命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4"><span class="nav-number">4.2.3.</span> <span class="nav-text">提交</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9E%E6%BB%9A"><span class="nav-number">4.2.4.</span> <span class="nav-text">回滚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">4.2.5.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">4.2.5.1.</span> <span class="nav-text">索引是什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9B%AE%E7%9A%84"><span class="nav-number">4.2.5.2.</span> <span class="nav-text">索引目的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86"><span class="nav-number">4.2.5.3.</span> <span class="nav-text">索引原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">4.2.5.4.</span> <span class="nav-text">索引的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90"><span class="nav-number">4.2.5.5.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.2.5.6.</span> <span class="nav-text">查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%EF%BC%9A"><span class="nav-number">4.2.5.7.</span> <span class="nav-text">注意：</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CKCat</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">112</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CKCat" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CKCat" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ckcatck@qq.com" title="E-Mail → mailto:ckcatck@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ckcat.github.io/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CKCat">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CKCat的博客">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MySQL基本使用 | CKCat的博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL基本使用
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-12-14 22:52:45" itemprop="dateCreated datePublished" datetime="2019-12-14T22:52:45+00:00">2019-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-09-06 02:09:37" itemprop="dateModified" datetime="2023-09-06T02:09:37+00:00">2023-09-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <blockquote>
<p>推荐使用 <a target="_blank" rel="noopener" href="https://github.com/dbcli/mycli">mycli</a> 操作 MySQL 数据库.</p>
</blockquote>
<h1 id="MySQL-使用"><a href="#MySQL-使用" class="headerlink" title="MySQL 使用"></a>MySQL 使用</h1><h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><p>命令行连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -uroot -p <span class="comment">#回车后输入密码。</span></span><br></pre></td></tr></table></figure>

<p>退出登录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ quit <span class="comment"># 或 exit 或 ctrl+D</span></span><br></pre></td></tr></table></figure>

<p>其他</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ select version();     <span class="comment"># 查看版本</span></span><br><span class="line">$ select now();         <span class="comment"># 查看当前时间</span></span><br></pre></td></tr></table></figure>

<img src="/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-15-16-32-28.png" class="">

<h2 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h2><p>查看所有的数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ show databases;</span><br></pre></td></tr></table></figure>

<p>使用数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ use 数据库名;</span><br></pre></td></tr></table></figure>

<p>查看当前使用的数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select database();</span><br></pre></td></tr></table></figure>

<p>创建数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ create database 数据库名 charset=utf8mb4;</span><br><span class="line"><span class="comment"># 例如：</span></span><br><span class="line">$ create database test01 charset=utf8mb4;</span><br></pre></td></tr></table></figure>

<p><strong>utf8mb4 才是正真的 utf8。</strong></p>
<p>查看创建数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ show create database 数据库名;</span><br><span class="line"><span class="comment"># 例如：</span></span><br><span class="line">$ show create database test01;</span><br></pre></td></tr></table></figure>

<p>删除数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ drop database 数据库名;</span><br><span class="line"><span class="comment"># 例如：</span></span><br><span class="line">$ drop database test01;</span><br></pre></td></tr></table></figure>

<p>当数据名称有特殊字符时，使用&#96;&#96;包起来。</p>
<h2 id="数据表操作"><a href="#数据表操作" class="headerlink" title="数据表操作"></a>数据表操作</h2><p>查看当前数据库中的所有表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ show tables;</span><br></pre></td></tr></table></figure>

<p>创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(id <span class="type">int</span>, name <span class="type">varchar</span>(<span class="number">100</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建xxx表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> xxxx(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key <span class="keyword">not</span> <span class="keyword">null</span> auto_increment,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">100</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建 students表（id、name、age、high, gender、cls_id)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> students(</span><br><span class="line">    id <span class="type">int</span> unsigned <span class="keyword">not</span> <span class="keyword">null</span> auto_increment <span class="keyword">primary</span> key,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    age tinyint unsigned,</span><br><span class="line">    high <span class="type">decimal</span>(<span class="number">5</span>, <span class="number">2</span>),</span><br><span class="line">    gender enum(&quot;男&quot;, &quot;女&quot;, &quot;保密&quot;) <span class="keyword">default</span> &quot;保密&quot;,</span><br><span class="line">    cls_id <span class="type">int</span> unsigned);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="number">0</span>, &quot;zhangsan&quot;, <span class="number">18</span>, <span class="number">188</span>, &quot;男&quot;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建classe表(id、name)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> classes(id <span class="type">int</span> unsigned <span class="keyword">not</span> <span class="keyword">null</span> auto_increment <span class="keyword">primary</span> key, name <span class="type">varchar</span>(<span class="number">30</span>));</span><br></pre></td></tr></table></figure>

<p>查看表结构</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ desc 表名;</span><br><span class="line"><span class="comment"># 例如：</span></span><br><span class="line">$ desc students;</span><br></pre></td></tr></table></figure>

<p>修改表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加字段 alter table 表名 add 列名 类型;</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">add</span> birthday datetime;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改字段 alter table 表名 modify 列名 类型;</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students modify birthday <span class="type">date</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改字段-重命名 alter table 表名 change 原名 新名 类型及约束;</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students modify birthday  birth <span class="type">date</span> <span class="keyword">default</span> &quot;2000-1-1&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除字段(尽量不用) alter table 表名 drop 列名;</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">drop</span> high;</span><br></pre></td></tr></table></figure>

<p>删除表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ drop table 表名; -- 删除表</span><br><span class="line">$ drop database 数据库; -- 删除数据库</span><br></pre></td></tr></table></figure>

<p>查看创建表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ show create table 表名;</span><br></pre></td></tr></table></figure>

<h2 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h2><p>增加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 全列插入</span></span><br><span class="line"><span class="comment">-- insert into 表名 values(...);</span></span><br><span class="line"><span class="comment">-- 主键字段 可以用0 null default 来占位</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> classes <span class="keyword">values</span>(<span class="number">0</span>, &quot;class02&quot;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="number">0</span>, &quot;lisi&quot;, <span class="number">18</span>, &quot;女&quot;, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="keyword">null</span>, &quot;lisi&quot;, <span class="number">18</span>, &quot;女&quot;, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="keyword">default</span>, &quot;lisi&quot;, <span class="number">18</span>, &quot;女&quot;, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="keyword">default</span>, &quot;lisi&quot;, <span class="number">18</span>, <span class="number">1</span>, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="keyword">default</span>, &quot;lisi&quot;, <span class="number">18</span>, <span class="number">3</span>, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 部分插入</span></span><br><span class="line"><span class="comment">-- insert into 表名(列1, 列2 ...) values(值1，值2);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入多行</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students (name, gender) <span class="keyword">values</span> (&quot;貂蝉&quot;, <span class="number">2</span>)，(&quot;大乔&quot;, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> students <span class="keyword">values</span>(<span class="keyword">default</span>, &quot;鲁班&quot;, <span class="number">18</span>, <span class="number">2</span>, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>), (<span class="keyword">default</span>, &quot;后羿&quot;, <span class="number">18</span>, <span class="number">1</span>, <span class="number">0</span>, &quot;2011-01-01&quot;, <span class="number">167</span>);</span><br></pre></td></tr></table></figure>

<p>修改</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- update 表名 set 列1=值1, 列2=值2 ... where 条件</span></span><br><span class="line"><span class="keyword">update</span> students <span class="keyword">set</span> gender<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> students <span class="keyword">set</span> gender<span class="operator">=</span><span class="number">2</span> <span class="keyword">where</span> id<span class="operator">&gt;</span><span class="number">6</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有的列</span></span><br><span class="line"><span class="comment">-- select * from 表名;</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students;</span><br><span class="line"><span class="comment">-- 查询name=&quot;lisi&quot;的所有数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> name<span class="operator">=</span>&quot;lisi&quot;;</span><br><span class="line"><span class="comment">-- 查询id &gt; 8的所有数据</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> students <span class="keyword">where</span> id<span class="operator">&gt;</span><span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询指定的列</span></span><br><span class="line"><span class="comment">-- select * 列1, 列2 ... from 表名;</span></span><br><span class="line"><span class="keyword">select</span> name, gender <span class="keyword">from</span> students;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 as 为列或表指定别名</span></span><br><span class="line"><span class="comment">-- select 字段[as 别名], 字段[as 别名] from 数据表 where ...;</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> 姓名, gender <span class="keyword">as</span> 性别 <span class="keyword">from</span> students;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字段的顺序</span></span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">as</span> 序号, gender <span class="keyword">as</span> 性别, name <span class="keyword">as</span> 姓名 <span class="keyword">from</span> students;</span><br></pre></td></tr></table></figure>

<p>删除(基本不会使用，一般用一个字段标记是否删除)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- delete from 表名 where 条件;</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> students;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> students <span class="keyword">where</span> name<span class="operator">=</span>&quot;lisi&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 逻辑删除</span></span><br><span class="line"><span class="comment">-- 给students 表添加一个 is_delete 字段，bit类型</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> students <span class="keyword">add</span> is_delete bit <span class="keyword">default</span> <span class="number">0</span>;</span><br><span class="line"><span class="comment">-- 删除</span></span><br><span class="line"><span class="keyword">update</span> students <span class="keyword">set</span> is_delete <span class="operator">=</span> <span class="number">1</span> <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">6</span>;</span><br></pre></td></tr></table></figure>

<h2 id="数据库备份和恢复"><a href="#数据库备份和恢复" class="headerlink" title="数据库备份和恢复"></a>数据库备份和恢复</h2><p>备份</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysqldump -u用户名 -p 数据库名 &gt; dump.sql <span class="comment">#按提示输入密码</span></span><br></pre></td></tr></table></figure>

<p>恢复</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u用户名 -p 新数据库名 &lt; dump.sql <span class="comment">#按提示输入密码</span></span><br></pre></td></tr></table></figure>

<h1 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h1><h2 id="三范式"><a href="#三范式" class="headerlink" title="三范式"></a>三范式</h2><p>经过研究和对使用中问题的总结，对于设计数据库提出了一些规范，这些规范被称为范式(Normal Form)，<br>目前有迹可寻的共有 8 种范式，一般需要遵守 3 范式即可。</p>
<ul>
<li>第一范式（1NF）：强调的是列的原子性，即列不能够再分成其他几列。</li>
<li>第二范式（2NF）：首先是 1NF，另外包含两部分内容，一是表必须有一个主键；二是没有包含在主键中的列必须完全依赖于主键，而不能只依赖于主键的一部分。</li>
<li>第三范式（3NF）：首先是 2NF，另外非主键列必须直接依赖于主键，不能存在传递依赖。即不能存在：非主键列 A 依赖于非主键列 B，非主键列 B 依赖于主键的情况。</li>
</ul>
<h2 id="E-R-模型"><a href="#E-R-模型" class="headerlink" title="E-R 模型"></a>E-R 模型</h2><ul>
<li>E 表示 entry-实体，设计实体就像定义一个类一样，指定从哪些方面描述对象，一个实体转换为数据库中的一个表。</li>
<li>R 表示 relationship-关系，关系描述两个实体之间的对应规则，关系的类型包括包括一对一、一对多、多对多。</li>
</ul>
<ol>
<li><p>一对一 :<br>但一个表的列太多时，并且某些列不经常出现在结果中，此时可以对列进行拆分，此时两个表的关系为一对一关系。实体 A 对实体 B 为 1 对 1，则在表 A 或表 B 中创建一个字段，存储另一个表的主键值。</p>
</li>
<li><p>一对多 :<br>A 表中的一条数据对应 B 表中的一条数据， B 表中的一条数据对应 A 表中的多条数据。此时 A 与 B 为多对一的关系。实体 A 对实体 B 为 1 对多：在表 B 中创建一个字段，存储表 A 的主键值。</p>
</li>
<li><p>多对多 :<br>A 表中的一条数据对应 B 表中的多条数据， B 表中的一条数据对应 A 表中的多条数据。此时 A 与 B 为多对多的关系。实体 A 对实体 B 为多对多：新建一张表 C，这个表只有两个字段，一个用于存储 A 的主键值，一个用于存储 B 的主键值。</p>
</li>
</ol>
<h1 id="更多查询用法"><a href="#更多查询用法" class="headerlink" title="更多查询用法"></a>更多查询用法</h1><p>消除重复行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ select distinct 列1, 列2 ... from 表名;</span><br><span class="line"><span class="comment"># 例如:</span></span><br><span class="line">$ select distinct gender from students;</span><br></pre></td></tr></table></figure>

<h2 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h2><p>使用 where 子句对表中的数据筛选，结果为 true 的行为会出现在结果集中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from 表名 <span class="built_in">where</span> 条件;</span><br></pre></td></tr></table></figure>

<p>where 后面支持多种运算符，进行条件的处理。</p>
<h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><ul>
<li>等于 &#x3D;</li>
<li>大于 &gt;</li>
<li>大于等于 &gt;&#x3D;</li>
<li>小于 &lt;</li>
<li>小于等于 &lt;&#x3D;</li>
<li>不等于 !&#x3D; 或 &lt;&gt;</li>
</ul>
<p>例： 查询编号大于 3 的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> <span class="built_in">id</span> &gt; 3;</span><br></pre></td></tr></table></figure>

<p>例：查询编号不大于 4 的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> <span class="built_in">id</span> &lt;= 4;</span><br></pre></td></tr></table></figure>

<p>例：查询姓名不是“黄蓉”的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> name != <span class="string">&quot;黄蓉&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>例：查询没被删除的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> is_delete=0;</span><br></pre></td></tr></table></figure>

<h2 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h2><ul>
<li>and</li>
<li>or</li>
<li>not</li>
</ul>
<p>例：查询编号大于 3 的女同学</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> <span class="built_in">id</span> &gt; 4 or gender = 0;</span><br></pre></td></tr></table></figure>

<p>例 6：查询编号小于 4 或没被删除的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> <span class="built_in">id</span> &lt; 4 or is_delete = 0;</span><br></pre></td></tr></table></figure>

<h2 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h2><ul>
<li><code>like</code></li>
<li><code>%</code> 表示任意多个任意字符</li>
<li><code>_</code> 表示一个任意字符</li>
</ul>
<p>例：查询姓黄的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> name like <span class="string">&quot;黄%&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>例：查询姓黄并且“名”是一个字的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> name like <span class="string">&quot;黄_&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>例：查询姓黄或叫靖的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> name like <span class="string">&quot;黄%&quot;</span> or name like <span class="string">&quot;%靖&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="范围查询"><a href="#范围查询" class="headerlink" title="范围查询"></a>范围查询</h2><ul>
<li><code>in</code> 表示在一个非连续的范围内</li>
</ul>
<p>例：查询编号是 1 或 3 或 8 的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> <span class="built_in">id</span> <span class="keyword">in</span>(1,3, 8);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>between ... and ...</code> 表示在一个连续的范围内</li>
</ul>
<p>例：查询编号为 3 至 8 的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> <span class="built_in">id</span> between 3 and 8;</span><br></pre></td></tr></table></figure>

<p>例：查询编号是 3 至 8 的男生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> (<span class="built_in">id</span> between 3 and 8) and gender = 1;</span><br></pre></td></tr></table></figure>

<h2 id="空判断"><a href="#空判断" class="headerlink" title="空判断"></a>空判断</h2><ul>
<li>注意: <code>null</code> 和 <code>&quot;&quot;</code> 是不同的</li>
<li>判空 <code>is null</code></li>
</ul>
<p>例：查询没有填写身高的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> height is null;</span><br></pre></td></tr></table></figure>

<ul>
<li>判非空 <code>is not null</code></li>
</ul>
<p>例：查询填写了身高的学生</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> height is not null and gender=1;</span><br></pre></td></tr></table></figure>

<h2 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h2><ul>
<li>优先级由高到低的顺序为：小括号，not，比较运算符，逻辑运算符</li>
<li>and 比 or 先运算，如果同时出现并希望先算 or，需要结合()使用</li>
</ul>
<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><p>语法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from 表名 order by 列1 asc|desc [,列2 asc|desc,...]</span><br></pre></td></tr></table></figure>

<p>说明</p>
<ul>
<li>将行数据按照列 1 进行排序，如果某些行列 1 的值相同时，则按照列 2 排序，以此类推</li>
<li>默认按照列值从小到大排列（asc）</li>
<li><code>asc</code> 从小到大排列，即升序</li>
<li><code>desc</code> 从大到小排序，即降序</li>
</ul>
<p>例：查询未删除男生信息，按学号降序</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ select * from students <span class="built_in">where</span> gender = 1 and is_delete = 0 order by <span class="built_in">id</span> desc;</span><br></pre></td></tr></table></figure>

<p>例：查询未删除学生信息，按名称升序(默认升序)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where is_delete=0 order by id;</span><br></pre></td></tr></table></figure>

<p>例 3：显示所有的学生信息，先按照年龄从大–&gt;小排序，当年龄相同时 按照身高从高–&gt;矮排序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students order by age, height desc;</span><br></pre></td></tr></table></figure>

<h2 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h2><ul>
<li>count(*)表示计算总行数，括号中写星与列名，结果是相同的</li>
</ul>
<p>例：查询学生总数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from students;</span><br></pre></td></tr></table></figure>

<ul>
<li>max(列)表示求此列的最大值</li>
</ul>
<p>例：查询女生的编号最大值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select max(id) from students where gender = 2;</span><br></pre></td></tr></table></figure>

<ul>
<li>min(列)表示求此列的最小值</li>
</ul>
<p>例：查询未删除的学生最小编号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select min(id) from students where is_delete = 0;</span><br></pre></td></tr></table></figure>

<ul>
<li>sum(列)表示求此列的和</li>
</ul>
<p>例：查询男生的总年龄</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select sum(age) from students where gender = 1;</span><br><span class="line">-- 平均年龄</span><br><span class="line">select sum(age)/count(*) from students where gender = 1;</span><br></pre></td></tr></table></figure>

<ul>
<li>avg(列)表示求此列的平均值</li>
</ul>
<p>例：查询未删除女生的编号平均值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select avg(age) from students where is_delete = 0 and gender = 2;</span><br></pre></td></tr></table></figure>

<h2 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h2><ul>
<li>group by 的含义:将查询结果按照 1 个或多个字段进行分组，字段值相同的为一组</li>
<li>group by 可用于单个字段分组，也可用于多个字段分组</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 根据gender字段来分组</span><br><span class="line">select gender from students group by gender;</span><br></pre></td></tr></table></figure>

<p>group by + group_concat()</p>
<ul>
<li>group_concat(字段名)可以作为一个输出字段来使用，</li>
<li>表示分组之后，根据分组结果，使用 group_concat()来放置每一组的某字段的值的集合</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select gender, group_concat(name) from students group by gender;</span><br><span class="line"></span><br><span class="line">select gender, group_concat(id) from students group by gender;</span><br><span class="line">+--------+------------------+</span><br><span class="line">| gender | group_concat(id) |</span><br><span class="line">+--------+------------------+</span><br><span class="line">| 男     | 3,4,8,9,13,15    |</span><br><span class="line">| 女     | 1,2,5,7,10,12,14 |</span><br><span class="line">| 中性   | 11               |</span><br><span class="line">| 保密   | 6                |</span><br><span class="line">+--------+------------------+</span><br></pre></td></tr></table></figure>

<p>group by + 集合函数</p>
<ul>
<li>通过 group_concat()的启发，我们既然可以统计出每个分组的某字段的值的集合，那么我们也可以通过集合函数来对这个值的集合做一些操作。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select gender, group_concat(age) from students group by gender;</span><br><span class="line"></span><br><span class="line">-- 分别统计性别为男/女的平均年龄</span><br><span class="line">select gender, avg(age) from students group by gender;</span><br><span class="line"></span><br><span class="line">-- 分别统计性别的个数</span><br><span class="line">select gender, count(*) from students group by gender;</span><br></pre></td></tr></table></figure>

<p>group by + having</p>
<ul>
<li>having 条件表达式：用来分组查询后指定一些条件来输出查询结果</li>
<li>having 作用和 where 一样，但 having 只能用于 group by</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select gender, count(*) from students group by gender</span><br><span class="line"> having count(*) &gt;2;</span><br></pre></td></tr></table></figure>

<p>group by + with rollup</p>
<ul>
<li>with rollup 的作用是：在最后新增一行，来记录当前列里所有记录的总和</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select gender, count(*) from students group by gender</span><br><span class="line">with rollup;</span><br><span class="line"></span><br><span class="line">select gender, group_concat(age) from students group by gender with rollup;</span><br></pre></td></tr></table></figure>

<h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h2><p>语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表名 limit start,count</span><br></pre></td></tr></table></figure>

<p>说明</p>
<ul>
<li>从 start 开始，获取 count 条数据</li>
</ul>
<p>例：查询前 3 行男生信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where gender = 1 limit 0,3;</span><br></pre></td></tr></table></figure>

<h2 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h2><p>当查询结果的列来源于多张表时，需要将多张表连接成一个大的数据集，再选择合适的列返回</p>
<p>mysql 支持三种类型的连接查询，分别为：</p>
<ul>
<li>内连接查询：查询的结果为两个表匹配到的数据</li>
</ul>
<img src="/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-12-55-40.png" class="">

<ul>
<li>右连接查询：查询的结果为两个表匹配到的数据，右表特有的数据，对于左表中不存在的数据使用 null 填充</li>
</ul>
<img src="/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-12-55-57.png" class="">

<ul>
<li>左连接查询：查询的结果为两个表匹配到的数据，左表特有的数据，对于右表中不存在的数据使用 null 填充</li>
</ul>
<img src="/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-12-56-06.png" class="">

<p>语法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from 表1 inner 或 left 或 right join 表2 on 表1.列 = 表2.列;</span><br></pre></td></tr></table></figure>

<p>例：使用内连接查询班级表与学生表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students inner join classes on students.cls_id = classes.id;</span><br></pre></td></tr></table></figure>

<p>例 2：使用左连接查询班级表与学生表, 此处使用了 as 为表起别名，目的是编写简单</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students as s left join classes as c on s.cls_id = c.id;</span><br></pre></td></tr></table></figure>

<p>例 3：使用右连接查询班级表与学生表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students as s right join classes as c on s.cls_id = c.id;</span><br></pre></td></tr></table></figure>

<p>例 4：查询学生姓名及班级名称</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select s.name, c.name from students as s inner join classes as c on s.cls_id = c.id;</span><br></pre></td></tr></table></figure>

<h2 id="自关联"><a href="#自关联" class="headerlink" title="自关联"></a>自关联</h2><ul>
<li><p>设计省信息的表结构 provinces</p>
<ul>
<li>id</li>
<li>ptitle</li>
</ul>
</li>
<li><p>设计市信息的表结构 citys</p>
<ul>
<li>id</li>
<li>ctitle</li>
<li>proid</li>
</ul>
</li>
<li><p>citys 表的 proid 表示城市所属的省，对应着 provinces 表的 id 值</p>
</li>
</ul>
<p>问题：</p>
<blockquote>
<p>能不能将两个表合成一张表呢？</p>
</blockquote>
<p>思考：</p>
<blockquote>
<p>观察两张表发现，citys 表比 provinces 表多一个列 proid，其它列的类型都是一样的</p>
</blockquote>
<p>意义：</p>
<blockquote>
<p>存储的都是地区信息，而且每种信息的数据量有限，没必要增加一个新表，或者将来还要存储区、乡镇信息，都增加新表的开销太大</p>
</blockquote>
<p>答案：</p>
<blockquote>
<p>定义表 areas，结构如下</p>
</blockquote>
<ul>
<li>id</li>
<li>atitle</li>
<li>pid</li>
</ul>
<p>说明:</p>
<ul>
<li>因为省没有所属的省份，所以可以填写为 null</li>
<li>城市所属的省份 pid，填写省所对应的编号 id</li>
<li>这就是自关联，表中的某一列，关联了这个表中的另外一列，但是它们的业务逻辑含义是不一样的，城市信息的 pid 引用的是省信息的 id</li>
<li>在这个表中，结构不变，可以添加区县、乡镇街道、村社区等信息</li>
</ul>
<img src="/2019/12/14/MySQL%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/2019-12-18-22-07-15.png" class="">

<ul>
<li>创建 areas 表的语句如下：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table areas(</span><br><span class="line">    aid int primary key,</span><br><span class="line">    atitle varchar(20),</span><br><span class="line">    pid int</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>从 sql 文件中导入数据, <code>areas.sql</code> <a target="_blank" rel="noopener" href="https://github.com/CKCat/Note/blob/master/Django/areas.sql">文件地址</a></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source areas.sql;</span><br></pre></td></tr></table></figure>

<ul>
<li>查询一共有多少个省</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from areas where pid is null;</span><br></pre></td></tr></table></figure>

<p>例：查询省的名称为“山西省”的所有城市</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select city.* from areas as city</span><br><span class="line">inner join areas as province on city.pid=province.aid</span><br><span class="line">where province.atitle=&#x27;山西省&#x27;;</span><br></pre></td></tr></table></figure>

<p>例：查询市的名称为“广州市”的所有区县</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select dis.* from areas as dis</span><br><span class="line">inner join areas as city on city.aid=dis.pid</span><br><span class="line">where city.atitle=&#x27;广州市&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询</p>
<blockquote>
<p>在一个 select 语句中,嵌入了另外一个 select 语句, 那么被嵌入的 select 语句称之为子查询语句。</p>
</blockquote>
<p>主查询</p>
<blockquote>
<p>主要查询的对象,第一条 select 语句</p>
</blockquote>
<p>主查询和子查询的关系</p>
<ul>
<li>子查询是嵌入到主查询中</li>
<li>子查询是辅助主查询的,要么充当条件,要么充当数据源</li>
<li>子查询是可以独立存在的语句,是一条完整的 select 语句</li>
</ul>
<p>子查询分类</p>
<ul>
<li>标量子查询: 子查询返回的结果是一个数据(一行一列)</li>
<li>列子查询: 返回的结果是一列(一列多行)</li>
<li>行子查询: 返回的结果是一行(一行多列)</li>
</ul>
<p>标量子查询 - 查询班级学生的平均身高</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where age &gt; (select avg(age) from students);</span><br></pre></td></tr></table></figure>

<p>列级子查询 - 查询还有学生在班的所有班级名字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select name from classes where id in (select cls_id from students);</span><br></pre></td></tr></table></figure>

<p>行级子查询 - 查找班级年龄最大,身高最高的学生</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from students where (height,age) = (select max(height),max(age) from students);</span><br></pre></td></tr></table></figure>

<p>子查询中特定关键字使用</p>
<ul>
<li>in 范围<ul>
<li>格式: 主查询 where 条件 in (列子查询)</li>
</ul>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>查询的完整格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT select_expr [,select_expr,...] [</span><br><span class="line">      FROM tb_name</span><br><span class="line">      [WHERE 条件判断]</span><br><span class="line">      [GROUP BY &#123;col_name | postion&#125; [ASC | DESC], ...]</span><br><span class="line">      [HAVING WHERE 条件判断]</span><br><span class="line">      [ORDER BY &#123;col_name|expr|postion&#125; [ASC | DESC], ...]</span><br><span class="line">      [ LIMIT &#123;[offset,]rowcount | row_count OFFSET offset&#125;]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>完整的 select 语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select distinct *</span><br><span class="line">from 表名</span><br><span class="line">where ....</span><br><span class="line">group by ... having ...</span><br><span class="line">order by ...</span><br><span class="line">limit start,count</span><br></pre></td></tr></table></figure>

<h1 id="MySql-高级"><a href="#MySql-高级" class="headerlink" title="MySql 高级"></a>MySql 高级</h1><h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><h3 id="视图是什么"><a href="#视图是什么" class="headerlink" title="视图是什么"></a>视图是什么</h3><p>通俗的讲，视图就是一条 SELECT 语句执行后返回的结果集。所以我们在创建视图的时候，主要的工作就落在创建这条 SQL 查询语句上。</p>
<p>视图是对若干张基本表的引用，一张虚表，查询语句执行的结果，不存储具体的数据（基本表数据发生了改变，视图也会跟着改变）；</p>
<p>方便操作，特别是查询操作，减少复杂的 SQL 语句，增强可读性；</p>
<h3 id="定义视图"><a href="#定义视图" class="headerlink" title="定义视图"></a>定义视图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create view 视图名称 as select语句;</span><br></pre></td></tr></table></figure>

<h3 id="查看视图"><a href="#查看视图" class="headerlink" title="查看视图"></a>查看视图</h3><p>查看表会将所有的视图也列出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show tables;</span><br></pre></td></tr></table></figure>

<h3 id="使用视图"><a href="#使用视图" class="headerlink" title="使用视图"></a>使用视图</h3><p>视图的用途就是查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from v_stu_score;</span><br></pre></td></tr></table></figure>

<h3 id="删除视图"><a href="#删除视图" class="headerlink" title="删除视图"></a>删除视图</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drop view 视图名称;</span><br><span class="line">例：</span><br><span class="line">drop view v_stu_sco;</span><br></pre></td></tr></table></figure>

<h3 id="视图的作用"><a href="#视图的作用" class="headerlink" title="视图的作用"></a>视图的作用</h3><ul>
<li>提高了重用性，就像一个函数</li>
<li>对数据库重构，却不影响程序的运行</li>
<li>提高了安全性能，可以对不同的用户</li>
<li>让数据更加清晰</li>
</ul>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>所谓事务,它是一个操作序列，这些操作要么都执行，要么都不执行，它是一个不可分割的工作单位。</p>
<h3 id="事务四大特性-简称-ACID"><a href="#事务四大特性-简称-ACID" class="headerlink" title="事务四大特性(简称 ACID)"></a>事务四大特性(简称 ACID)</h3><h4 id="原子性-Atomicity"><a href="#原子性-Atomicity" class="headerlink" title="原子性(Atomicity)"></a>原子性(Atomicity)</h4><p>一个事务必须被视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性.</p>
<h4 id="一致性-Consistency"><a href="#一致性-Consistency" class="headerlink" title="一致性(Consistency)"></a>一致性(Consistency)</h4><p>数据库总是从一个一致性的状态转换到另一个一致性的状态。（在前面的例子中，一致性确保了，即使在执行第三、四条语句之间时系统崩溃，支票账户中也不会损失 200 美元，因为事务最终没有提交，所以事务中所做的修改也不会保存到数据库中。）</p>
<h4 id="隔离性-Isolation"><a href="#隔离性-Isolation" class="headerlink" title="隔离性(Isolation)"></a>隔离性(Isolation)</h4><p>通常来说，一个事务所做的修改在最终提交以前，对其他事务是不可见的。（在前面的例子中，当执行完第三条语句、第四条语句还未开始时，此时有另外的一个账户汇总程序开始运行，则其看到支票帐户的余额并没有被减去 200 美元。）</p>
<h4 id="持久性-Durability"><a href="#持久性-Durability" class="headerlink" title="持久性(Durability)"></a>持久性(Durability)</h4><p>一旦事务提交，则其所做的修改会永久保存到数据库。（此时即使系统崩溃，修改的数据也不会丢失。）</p>
<h3 id="事务命令"><a href="#事务命令" class="headerlink" title="事务命令"></a>事务命令</h3><p>表的引擎类型必须是 innodb 类型才可以使用事务，这是 mysql 表的默认引擎</p>
<p>查看表的创建语句，可以看到 engine&#x3D;innodb</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- 选择数据库</span><br><span class="line">use jing_dong;</span><br><span class="line">-- 查看goods表</span><br><span class="line">show create table goods;</span><br></pre></td></tr></table></figure>

<p>开启事务，命令如下：</p>
<p>开启事务后执行修改命令，变更会维护到本地缓存中，而不维护到物理表中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin;</span><br><span class="line">或者</span><br><span class="line">start transaction;</span><br></pre></td></tr></table></figure>

<p>提交事务，命令如下</p>
<p>将缓存中的数据变更维护到物理表中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commit;</span><br></pre></td></tr></table></figure>

<p>回滚事务，命令如下：</p>
<p>放弃缓存中变更的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollback;</span><br></pre></td></tr></table></figure>

<p>注意</p>
<ul>
<li>修改数据的命令会自动的触发事务，包括 insert、update、delete</li>
<li>而在 SQL 语句中有手动开启事务的原因是：可以进行多次数据的修改，如果成功一起成功，否则一起会滚到之前的数据</li>
</ul>
<h3 id="提交"><a href="#提交" class="headerlink" title="提交"></a>提交</h3><p>为了演示效果，需要打开两个终端窗口，使用同一个数据库，操作同一张表</p>
<p>step1：连接</p>
<p>终端 1：查询商品分类信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<p>step2：增加数据</p>
<p>终端 2：开启事务，插入数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">begin;</span><br><span class="line">insert into goods_cates(name) values(&#x27;小霸王游戏机&#x27;);</span><br></pre></td></tr></table></figure>

<p>终端 2：查询数据，此时有新增的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<p>step3：查询</p>
<p>终端 1：查询数据，发现并没有新增的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<p>step4：提交</p>
<p>终端 2：完成提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commit;</span><br></pre></td></tr></table></figure>

<p>step5：查询</p>
<p>终端 1：查询，发现有新增的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<h3 id="回滚"><a href="#回滚" class="headerlink" title="回滚"></a>回滚</h3><p>为了演示效果，需要打开两个终端窗口，使用同一个数据库，操作同一张表</p>
<p>step1：连接</p>
<p>终端 1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<p>step2：增加数据</p>
<p>终端 2：开启事务，插入数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">begin;</span><br><span class="line">insert into goods_cates(name) values(&#x27;小霸王游戏机&#x27;);</span><br></pre></td></tr></table></figure>

<p>终端 2：查询数据，此时有新增的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<p>step3：查询</p>
<p>终端 1：查询数据，发现并没有新增的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<p>step4：回滚</p>
<p>终端 2：完成回滚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rollback;</span><br></pre></td></tr></table></figure>

<p>step5：查询</p>
<p>终端 1：查询数据，发现没有新增的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from goods_cates;</span><br></pre></td></tr></table></figure>

<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><h4 id="索引是什么"><a href="#索引是什么" class="headerlink" title="索引是什么"></a>索引是什么</h4><p>索引是一种特殊的文件(InnoDB 数据表上的索引是表空间的一个组成部分)，它们包含着对数据表里所有记录的引用指针。</p>
<p>更通俗的说，数据库索引好比是一本书前面的目录，能加快数据库的查询速度。</p>
<h4 id="索引目的"><a href="#索引目的" class="headerlink" title="索引目的"></a>索引目的</h4><p>索引的目的在于提高查询效率，可以类比字典，如果要查“mysql”这个单词，我们肯定需要定位到 m 字母，然后从下往下找到 y 字母，再找到剩下的 sql。如果没有索引，那么你可能需要把所有单词看一遍才能找到你想要的，如果我想找到 m 开头的单词呢？或者 ze 开头的单词呢？是不是觉得如果没有索引，这个事情根本无法完成？</p>
<h4 id="索引原理"><a href="#索引原理" class="headerlink" title="索引原理"></a>索引原理</h4><p>除了词典，生活中随处可见索引的例子，如火车站的车次表、图书的目录等。它们的原理都是一样的，通过不断的缩小想要获得数据的范围来筛选出最终想要的结果，同时把随机的事件变成顺序的事件，也就是我们总是通过同一种查找方式来锁定数据。</p>
<p>数据库也是一样，但显然要复杂许多，因为不仅面临着等值查询，还有范围查询(&gt;、&lt;、between、in)、模糊查询(like)、并集查询(or)等等。数据库应该选择怎么样的方式来应对所有的问题呢？我们回想字典的例子，能不能把数据分成段，然后分段查询呢？最简单的如果 1000 条数据，1 到 100 分成第一段，101 到 200 分成第二段，201 到 300 分成第三段……这样查第 250 条数据，只要找第三段就可以了，一下子去除了 90%的无效数据。</p>
<h4 id="索引的使用"><a href="#索引的使用" class="headerlink" title="索引的使用"></a>索引的使用</h4><p>查看索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show index from 表名;</span><br></pre></td></tr></table></figure>

<p>创建索引</p>
<ul>
<li>如果指定字段是字符串，需要指定长度，建议长度与定义字段时的长度一致</li>
<li>字段类型如果不是字符串，可以不填写长度部分</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create index 索引名称 on 表名(字段名称(长度))</span><br></pre></td></tr></table></figure>

<p>删除索引：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名称 on 表名;</span><br></pre></td></tr></table></figure>

<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>创建测试表 testindex</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table test_index(title varchar(10));</span><br></pre></td></tr></table></figure>

<p>使用 python 程序通过 pymsql 模块 向表中加入十万条数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from pymysql import *</span><br><span class="line"></span><br><span class="line">def insert():</span><br><span class="line">    # 创建 Connection 连接</span><br><span class="line">    conn = connect(host=&quot;localhost&quot;, port=3306, database=&quot;jing_dong&quot;, user=&quot;ckcat&quot;, password=&quot;mysql&quot;, charset=&quot;utf8mb4&quot;)</span><br><span class="line">    # 获得 Cursor 对象</span><br><span class="line">    cs = conn.cursor()</span><br><span class="line"></span><br><span class="line">    # 插入10万次数据</span><br><span class="line">    for i in range(100000):</span><br><span class="line">        cs.execute(&quot;insert into test_index values(&#x27;ha-%d&#x27;)&quot; % i)</span><br><span class="line">    # 提交数据</span><br><span class="line">    conn.commit()</span><br><span class="line"></span><br><span class="line">    # 关闭 cursor 对象 和 Connection 对象</span><br><span class="line">    cs.close()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    insert()</span><br></pre></td></tr></table></figure>

<h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><p>开启运行时间监测：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set profiling=1;</span><br></pre></td></tr></table></figure>

<p>查找第 1 万条数据 ha-99999</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test_index where title=&#x27;ha-99999&#x27;;</span><br></pre></td></tr></table></figure>

<p>查看执行的时间：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show profiles;</span><br></pre></td></tr></table></figure>

<p>为表 title_index 的 title 列创建索引：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create index title_index on test_index(title(10));</span><br></pre></td></tr></table></figure>

<p>执行查询语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from test_index where title=&#x27;ha-99999&#x27;;</span><br></pre></td></tr></table></figure>

<p>再次查看执行的时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show profiles;</span><br></pre></td></tr></table></figure>

<h4 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h4><p>要注意的是，建立太多的索引将会影响更新和插入的速度，因为它需要同样更新每个索引文件。对于一个经常需要更新和插入的表格，就没有必要为一个很少使用的 where 字句单独建立索引了，对于比较小的表，排序的开销不会很大，也没有必要建立另外的索引。</p>
<p>建立索引会占用磁盘空间</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/12/14/Django%E5%AD%A6%E4%B9%A0-%E6%A8%A1%E5%9E%8B/" rel="prev" title="Django学习-模型">
                  <i class="fa fa-chevron-left"></i> Django学习-模型
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/12/15/MySQL%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/" rel="next" title="MySQL的安装和配置">
                  MySQL的安装和配置 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CKCat</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/CKCat" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
